{"version":3,"file":"animation-B5U3lJZQ.js","sources":["../../panels/animation/AnimationDOMNode.js","../../panels/animation/AnimationModel.js","../../panels/animation/animationScreenshotPopover.css.js","../../panels/animation/AnimationScreenshotPopover.js","../../panels/animation/animationTimeline.css.js","../../panels/animation/AnimationTimeline.js","../../panels/animation/AnimationUI.js","../../panels/animation/AnimationGroupPreviewUI.js"],"sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as SDK from '../../core/sdk/sdk.js';\nconst DEVTOOLS_ANIMATIONS_WORLD_NAME = 'devtools_animations';\nconst REPORT_SCROLL_POSITION_BINDING_NAME = '__devtools_report_scroll_position__';\nconst getScrollListenerNameInPage = (id) => `__devtools_scroll_listener_${id}__`;\nasync function resolveToObjectInWorld(domNode, worldName) {\n    const resourceTreeModel = domNode.domModel().target().model(SDK.ResourceTreeModel.ResourceTreeModel);\n    const pageAgent = domNode.domModel().target().pageAgent();\n    for (const frame of resourceTreeModel.frames()) {\n        // This returns previously created world if it exists for the frame.\n        const { executionContextId } = await pageAgent.invoke_createIsolatedWorld({ frameId: frame.id, worldName });\n        const object = await domNode.resolveToObject(undefined, executionContextId);\n        if (object) {\n            return object;\n        }\n    }\n    return null;\n}\n/**\n * Provides an extension over `SDK.DOMModel.DOMNode` that gives it additional\n * capabilities for animation debugging, mainly:\n * - getting a node's scroll information (scroll offsets and scroll range).\n * - updating a node's scroll offset.\n * - tracking the node's scroll offsets with event listeners.\n *\n * It works by running functions on the target page, see `SDK.DOMModel.DOMNode`s `callFunction` method\n * for more details on how a function is called on the target page.\n *\n * For listening to events on the target page and getting notified on the devtools frontend\n * side, we're adding a binding to the page `__devtools_report_scroll_position__` in a world `devtools_animation`\n * we've created. Then, we're setting scroll listeners of the `node` in the same world which calls the binding\n * itself with the scroll offsets.\n */\nexport class AnimationDOMNode {\n    #domNode;\n    #scrollListenersById;\n    #scrollBindingListener;\n    static lastAddedListenerId = 0;\n    constructor(domNode) {\n        this.#domNode = domNode;\n        this.#scrollListenersById = new Map();\n    }\n    async #addReportScrollPositionBinding() {\n        // The binding is already added so we don't need to add it again.\n        if (this.#scrollBindingListener) {\n            return;\n        }\n        this.#scrollBindingListener = ev => {\n            const { name, payload } = ev.data;\n            if (name !== REPORT_SCROLL_POSITION_BINDING_NAME) {\n                return;\n            }\n            const { scrollTop, scrollLeft, id } = JSON.parse(payload);\n            const scrollListener = this.#scrollListenersById.get(id);\n            if (!scrollListener) {\n                return;\n            }\n            scrollListener({ scrollTop, scrollLeft });\n        };\n        const runtimeModel = this.#domNode.domModel().target().model(SDK.RuntimeModel.RuntimeModel);\n        await runtimeModel.addBinding({\n            name: REPORT_SCROLL_POSITION_BINDING_NAME,\n            executionContextName: DEVTOOLS_ANIMATIONS_WORLD_NAME,\n        });\n        runtimeModel.addEventListener(SDK.RuntimeModel.Events.BindingCalled, this.#scrollBindingListener);\n    }\n    async #removeReportScrollPositionBinding() {\n        // There isn't any binding added yet.\n        if (!this.#scrollBindingListener) {\n            return;\n        }\n        const runtimeModel = this.#domNode.domModel().target().model(SDK.RuntimeModel.RuntimeModel);\n        await runtimeModel.removeBinding({\n            name: REPORT_SCROLL_POSITION_BINDING_NAME,\n        });\n        runtimeModel.removeEventListener(SDK.RuntimeModel.Events.BindingCalled, this.#scrollBindingListener);\n        this.#scrollBindingListener = undefined;\n    }\n    async addScrollEventListener(onScroll) {\n        AnimationDOMNode.lastAddedListenerId++;\n        const id = AnimationDOMNode.lastAddedListenerId;\n        this.#scrollListenersById.set(id, onScroll);\n        // Add the binding for reporting scroll events from the page if it doesn't exist.\n        if (!this.#scrollBindingListener) {\n            await this.#addReportScrollPositionBinding();\n        }\n        const object = await resolveToObjectInWorld(this.#domNode, DEVTOOLS_ANIMATIONS_WORLD_NAME);\n        if (!object) {\n            return null;\n        }\n        await object.callFunction(scrollListenerInPage, [\n            id,\n            REPORT_SCROLL_POSITION_BINDING_NAME,\n            getScrollListenerNameInPage(id),\n        ].map(arg => SDK.RemoteObject.RemoteObject.toCallArgument(arg)));\n        object.release();\n        return id;\n        function scrollListenerInPage(id, reportScrollPositionBindingName, scrollListenerNameInPage) {\n            if ('scrollingElement' in this && !this.scrollingElement) {\n                return;\n            }\n            const scrollingElement = ('scrollingElement' in this ? this.scrollingElement : this);\n            // @ts-ignore We're setting a custom field on `Element` or `Document` for retaining the function on the page.\n            this[scrollListenerNameInPage] = () => {\n                // @ts-ignore `reportScrollPosition` binding is injected to the page before calling the function.\n                globalThis[reportScrollPositionBindingName](JSON.stringify({ scrollTop: scrollingElement.scrollTop, scrollLeft: scrollingElement.scrollLeft, id }));\n            };\n            // @ts-ignore We've already defined the function used below.\n            this.addEventListener('scroll', this[scrollListenerNameInPage], true);\n        }\n    }\n    async removeScrollEventListener(id) {\n        const object = await resolveToObjectInWorld(this.#domNode, DEVTOOLS_ANIMATIONS_WORLD_NAME);\n        if (!object) {\n            return;\n        }\n        await object.callFunction(removeScrollListenerInPage, [getScrollListenerNameInPage(id)].map(arg => SDK.RemoteObject.RemoteObject.toCallArgument(arg)));\n        object.release();\n        this.#scrollListenersById.delete(id);\n        // There aren't any scroll listeners remained on the page\n        // so we remove the binding.\n        if (this.#scrollListenersById.size === 0) {\n            await this.#removeReportScrollPositionBinding();\n        }\n        function removeScrollListenerInPage(scrollListenerNameInPage) {\n            // @ts-ignore We've already set this custom field while adding scroll listener.\n            this.removeEventListener('scroll', this[scrollListenerNameInPage]);\n            // @ts-ignore We've already set this custom field while adding scroll listener.\n            delete this[scrollListenerNameInPage];\n        }\n    }\n    async scrollTop() {\n        return this.#domNode.callFunction(scrollTopInPage).then(res => res?.value ?? null);\n        function scrollTopInPage() {\n            if ('scrollingElement' in this) {\n                if (!this.scrollingElement) {\n                    return 0;\n                }\n                return this.scrollingElement.scrollTop;\n            }\n            return this.scrollTop;\n        }\n    }\n    async scrollLeft() {\n        return this.#domNode.callFunction(scrollLeftInPage).then(res => res?.value ?? null);\n        function scrollLeftInPage() {\n            if ('scrollingElement' in this) {\n                if (!this.scrollingElement) {\n                    return 0;\n                }\n                return this.scrollingElement.scrollLeft;\n            }\n            return this.scrollLeft;\n        }\n    }\n    async setScrollTop(offset) {\n        await this.#domNode.callFunction(setScrollTopInPage, [offset]);\n        function setScrollTopInPage(offsetInPage) {\n            if ('scrollingElement' in this) {\n                if (!this.scrollingElement) {\n                    return;\n                }\n                this.scrollingElement.scrollTop = offsetInPage;\n            }\n            else {\n                this.scrollTop = offsetInPage;\n            }\n        }\n    }\n    async setScrollLeft(offset) {\n        await this.#domNode.callFunction(setScrollLeftInPage, [offset]);\n        function setScrollLeftInPage(offsetInPage) {\n            if ('scrollingElement' in this) {\n                if (!this.scrollingElement) {\n                    return;\n                }\n                this.scrollingElement.scrollLeft = offsetInPage;\n            }\n            else {\n                this.scrollLeft = offsetInPage;\n            }\n        }\n    }\n    async verticalScrollRange() {\n        return this.#domNode.callFunction(verticalScrollRangeInPage).then(res => res?.value ?? null);\n        function verticalScrollRangeInPage() {\n            if ('scrollingElement' in this) {\n                if (!this.scrollingElement) {\n                    return 0;\n                }\n                return this.scrollingElement.scrollHeight - this.scrollingElement.clientHeight;\n            }\n            return this.scrollHeight - this.clientHeight;\n        }\n    }\n    async horizontalScrollRange() {\n        return this.#domNode.callFunction(horizontalScrollRangeInPage).then(res => res?.value ?? null);\n        function horizontalScrollRangeInPage() {\n            if ('scrollingElement' in this) {\n                if (!this.scrollingElement) {\n                    return 0;\n                }\n                return this.scrollingElement.scrollWidth - this.scrollingElement.clientWidth;\n            }\n            return this.scrollWidth - this.clientWidth;\n        }\n    }\n}\n//# sourceMappingURL=AnimationDOMNode.js.map","// Copyright (c) 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as Common from '../../core/common/common.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport { AnimationDOMNode } from './AnimationDOMNode.js';\nfunction shouldGroupAnimations(firstAnimation, anim) {\n    const firstAnimationTimeline = firstAnimation.viewOrScrollTimeline();\n    const animationTimeline = anim.viewOrScrollTimeline();\n    if (firstAnimationTimeline) {\n        // This is a SDA group so check whether the animation's\n        // scroll container and scroll axis is the same with the first animation.\n        return Boolean(animationTimeline && firstAnimationTimeline.sourceNodeId === animationTimeline.sourceNodeId &&\n            firstAnimationTimeline.axis === animationTimeline.axis);\n    }\n    // This is a non-SDA group so check whether the coming animation\n    // is a time based one too and if so, compare their start times.\n    return !animationTimeline && firstAnimation.startTime() === anim.startTime();\n}\nexport class AnimationModel extends SDK.SDKModel.SDKModel {\n    runtimeModel;\n    agent;\n    #animationsById;\n    animationGroups;\n    #pendingAnimations;\n    playbackRate;\n    #screenshotCapture;\n    #enabled;\n    #flushPendingAnimations;\n    constructor(target) {\n        super(target);\n        this.runtimeModel = target.model(SDK.RuntimeModel.RuntimeModel);\n        this.agent = target.animationAgent();\n        target.registerAnimationDispatcher(new AnimationDispatcher(this));\n        this.#animationsById = new Map();\n        this.animationGroups = new Map();\n        this.#pendingAnimations = new Set();\n        this.playbackRate = 1;\n        const resourceTreeModel = target.model(SDK.ResourceTreeModel.ResourceTreeModel);\n        resourceTreeModel.addEventListener(SDK.ResourceTreeModel.Events.PrimaryPageChanged, this.reset, this);\n        const screenCaptureModel = target.model(SDK.ScreenCaptureModel.ScreenCaptureModel);\n        if (screenCaptureModel) {\n            this.#screenshotCapture = new ScreenshotCapture(this, screenCaptureModel);\n        }\n        this.#flushPendingAnimations = Common.Debouncer.debounce(() => {\n            while (this.#pendingAnimations.size) {\n                this.matchExistingGroups(this.createGroupFromPendingAnimations());\n            }\n        }, 100);\n    }\n    reset() {\n        this.#animationsById.clear();\n        this.animationGroups.clear();\n        this.#pendingAnimations.clear();\n        this.dispatchEventToListeners(Events.ModelReset);\n    }\n    async devicePixelRatio() {\n        const evaluateResult = await this.target().runtimeAgent().invoke_evaluate({ expression: 'window.devicePixelRatio' });\n        if (evaluateResult?.result.type === 'number') {\n            return evaluateResult?.result.value ?? 1;\n        }\n        return 1;\n    }\n    animationCanceled(id) {\n        this.#pendingAnimations.delete(id);\n    }\n    async animationUpdated(payload) {\n        let foundAnimationGroup;\n        let foundAnimation;\n        for (const animationGroup of this.animationGroups.values()) {\n            foundAnimation = animationGroup.animations().find(animation => animation.id() === payload.id);\n            if (foundAnimation) {\n                foundAnimationGroup = animationGroup;\n                break;\n            }\n        }\n        if (!foundAnimation || !foundAnimationGroup) {\n            return;\n        }\n        await foundAnimation.setPayload(payload);\n        this.dispatchEventToListeners(Events.AnimationGroupUpdated, foundAnimationGroup);\n    }\n    async animationStarted(payload) {\n        // We are not interested in animations without effect or target.\n        if (!payload.source || !payload.source.backendNodeId) {\n            return;\n        }\n        const animation = await AnimationImpl.parsePayload(this, payload);\n        // Ignore Web Animations custom effects & groups.\n        const keyframesRule = animation.source().keyframesRule();\n        if (animation.type() === 'WebAnimation' && keyframesRule && keyframesRule.keyframes().length === 0) {\n            this.#pendingAnimations.delete(animation.id());\n        }\n        else {\n            this.#animationsById.set(animation.id(), animation);\n            this.#pendingAnimations.add(animation.id());\n        }\n        this.#flushPendingAnimations();\n    }\n    matchExistingGroups(incomingGroup) {\n        let matchedGroup = null;\n        for (const group of this.animationGroups.values()) {\n            if (group.matches(incomingGroup)) {\n                matchedGroup = group;\n                group.rebaseTo(incomingGroup);\n                break;\n            }\n            if (group.shouldInclude(incomingGroup)) {\n                matchedGroup = group;\n                group.appendAnimations(incomingGroup.animations());\n                break;\n            }\n        }\n        if (!matchedGroup) {\n            this.animationGroups.set(incomingGroup.id(), incomingGroup);\n            if (this.#screenshotCapture) {\n                this.#screenshotCapture.captureScreenshots(incomingGroup.finiteDuration(), incomingGroup.screenshotsInternal);\n            }\n            this.dispatchEventToListeners(Events.AnimationGroupStarted, incomingGroup);\n        }\n        else {\n            this.dispatchEventToListeners(Events.AnimationGroupUpdated, matchedGroup);\n        }\n        return Boolean(matchedGroup);\n    }\n    createGroupFromPendingAnimations() {\n        console.assert(this.#pendingAnimations.size > 0);\n        const firstAnimationId = this.#pendingAnimations.values().next().value;\n        this.#pendingAnimations.delete(firstAnimationId);\n        const firstAnimation = this.#animationsById.get(firstAnimationId);\n        if (!firstAnimation) {\n            throw new Error('Unable to locate first animation');\n        }\n        const groupedAnimations = [firstAnimation];\n        const remainingAnimations = new Set();\n        for (const id of this.#pendingAnimations) {\n            const anim = this.#animationsById.get(id);\n            if (shouldGroupAnimations(firstAnimation, anim)) {\n                groupedAnimations.push(anim);\n            }\n            else {\n                remainingAnimations.add(id);\n            }\n        }\n        this.#pendingAnimations = remainingAnimations;\n        // Show the first starting animation at the top of the animations of the animation group.\n        groupedAnimations.sort((anim1, anim2) => anim1.startTime() - anim2.startTime());\n        return new AnimationGroup(this, firstAnimationId, groupedAnimations);\n    }\n    setPlaybackRate(playbackRate) {\n        this.playbackRate = playbackRate;\n        void this.agent.invoke_setPlaybackRate({ playbackRate });\n    }\n    releaseAnimations(animations) {\n        void this.agent.invoke_releaseAnimations({ animations });\n    }\n    async suspendModel() {\n        this.reset();\n        await this.agent.invoke_disable();\n    }\n    async resumeModel() {\n        if (!this.#enabled) {\n            return;\n        }\n        await this.agent.invoke_enable();\n    }\n    async ensureEnabled() {\n        if (this.#enabled) {\n            return;\n        }\n        await this.agent.invoke_enable();\n        this.#enabled = true;\n    }\n}\nexport var Events;\n(function (Events) {\n    /* eslint-disable @typescript-eslint/naming-convention -- Used by web_tests. */\n    Events[\"AnimationGroupStarted\"] = \"AnimationGroupStarted\";\n    Events[\"AnimationGroupUpdated\"] = \"AnimationGroupUpdated\";\n    Events[\"ModelReset\"] = \"ModelReset\";\n    /* eslint-enable @typescript-eslint/naming-convention */\n})(Events || (Events = {}));\nexport class AnimationImpl {\n    #animationModel;\n    #payloadInternal; // Assertion is safe because only way to create `AnimationImpl` is to use `parsePayload` which calls `setPayload` and sets the value.\n    #sourceInternal; // Assertion is safe because only way to create `AnimationImpl` is to use `parsePayload` which calls `setPayload` and sets the value.\n    #playStateInternal;\n    constructor(animationModel) {\n        this.#animationModel = animationModel;\n    }\n    static async parsePayload(animationModel, payload) {\n        const animation = new AnimationImpl(animationModel);\n        await animation.setPayload(payload);\n        return animation;\n    }\n    async setPayload(payload) {\n        // TODO(b/40929569): Remove normalizing by devicePixelRatio after the attached bug is resolved.\n        if (payload.viewOrScrollTimeline) {\n            const devicePixelRatio = await this.#animationModel.devicePixelRatio();\n            if (payload.viewOrScrollTimeline.startOffset) {\n                payload.viewOrScrollTimeline.startOffset /= devicePixelRatio;\n            }\n            if (payload.viewOrScrollTimeline.endOffset) {\n                payload.viewOrScrollTimeline.endOffset /= devicePixelRatio;\n            }\n        }\n        this.#payloadInternal = payload;\n        if (this.#sourceInternal && payload.source) {\n            this.#sourceInternal.setPayload(payload.source);\n        }\n        else if (!this.#sourceInternal && payload.source) {\n            this.#sourceInternal = new AnimationEffect(this.#animationModel, payload.source);\n        }\n    }\n    // `startTime` and `duration` is represented as the\n    // percentage of the view timeline range that starts at `startOffset`px\n    // from the scroll container and ends at `endOffset`px of the scroll container.\n    // This takes a percentage of the timeline range and returns the absolute\n    // pixels values as a scroll offset of the scroll container.\n    percentageToPixels(percentage, viewOrScrollTimeline) {\n        const { startOffset, endOffset } = viewOrScrollTimeline;\n        if (startOffset === undefined || endOffset === undefined) {\n            // We don't expect this situation to occur since after an animation is started\n            // we expect the scroll offsets to be resolved and provided correctly. If `startOffset`\n            // or `endOffset` is not provided in a viewOrScrollTimeline; we can assume that there is a bug here\n            // so it's fine to throw an error.\n            throw new Error('startOffset or endOffset does not exist in viewOrScrollTimeline');\n        }\n        return (endOffset - startOffset) * (percentage / 100);\n    }\n    viewOrScrollTimeline() {\n        return this.#payloadInternal.viewOrScrollTimeline;\n    }\n    id() {\n        return this.#payloadInternal.id;\n    }\n    name() {\n        return this.#payloadInternal.name;\n    }\n    paused() {\n        return this.#payloadInternal.pausedState;\n    }\n    playState() {\n        return this.#playStateInternal || this.#payloadInternal.playState;\n    }\n    setPlayState(playState) {\n        this.#playStateInternal = playState;\n    }\n    playbackRate() {\n        return this.#payloadInternal.playbackRate;\n    }\n    // For scroll driven animations, it returns the pixel offset in the scroll container\n    // For time animations, it returns milliseconds.\n    startTime() {\n        const viewOrScrollTimeline = this.viewOrScrollTimeline();\n        if (viewOrScrollTimeline) {\n            return this.percentageToPixels(this.playbackRate() > 0 ? this.#payloadInternal.startTime : 100 - this.#payloadInternal.startTime, viewOrScrollTimeline) +\n                (this.viewOrScrollTimeline()?.startOffset ?? 0);\n        }\n        return this.#payloadInternal.startTime;\n    }\n    // For scroll driven animations, it returns the duration in pixels (i.e. after how many pixels of scroll the animation is going to end)\n    // For time animations, it returns milliseconds.\n    iterationDuration() {\n        const viewOrScrollTimeline = this.viewOrScrollTimeline();\n        if (viewOrScrollTimeline) {\n            return this.percentageToPixels(this.source().duration(), viewOrScrollTimeline);\n        }\n        return this.source().duration();\n    }\n    // For scroll driven animations, it returns the duration in pixels (i.e. after how many pixels of scroll the animation is going to end)\n    // For time animations, it returns milliseconds.\n    endTime() {\n        if (!this.source().iterations) {\n            return Infinity;\n        }\n        if (this.viewOrScrollTimeline()) {\n            return this.startTime() + this.iterationDuration() * this.source().iterations();\n        }\n        return this.startTime() + this.source().delay() + this.source().duration() * this.source().iterations() +\n            this.source().endDelay();\n    }\n    // For scroll driven animations, it returns the duration in pixels (i.e. after how many pixels of scroll the animation is going to end)\n    // For time animations, it returns milliseconds.\n    finiteDuration() {\n        const iterations = Math.min(this.source().iterations(), 3);\n        if (this.viewOrScrollTimeline()) {\n            return this.iterationDuration() * iterations;\n        }\n        return this.source().delay() + this.source().duration() * iterations;\n    }\n    // For scroll driven animations, it returns the duration in pixels (i.e. after how many pixels of scroll the animation is going to end)\n    // For time animations, it returns milliseconds.\n    currentTime() {\n        const viewOrScrollTimeline = this.viewOrScrollTimeline();\n        if (viewOrScrollTimeline) {\n            return this.percentageToPixels(this.#payloadInternal.currentTime, viewOrScrollTimeline);\n        }\n        return this.#payloadInternal.currentTime;\n    }\n    source() {\n        return this.#sourceInternal;\n    }\n    type() {\n        return this.#payloadInternal.type;\n    }\n    overlaps(animation) {\n        // Infinite animations\n        if (!this.source().iterations() || !animation.source().iterations()) {\n            return true;\n        }\n        const firstAnimation = this.startTime() < animation.startTime() ? this : animation;\n        const secondAnimation = firstAnimation === this ? animation : this;\n        return firstAnimation.endTime() >= secondAnimation.startTime();\n    }\n    // Utility method for returning `delay` for time based animations\n    // and `startTime` in pixels for scroll driven animations. It is used to\n    // find the exact starting time of the first keyframe for both cases.\n    delayOrStartTime() {\n        if (this.viewOrScrollTimeline()) {\n            return this.startTime();\n        }\n        return this.source().delay();\n    }\n    setTiming(duration, delay) {\n        void this.#sourceInternal.node().then(node => {\n            if (!node) {\n                throw new Error('Unable to find node');\n            }\n            this.updateNodeStyle(duration, delay, node);\n        });\n        this.#sourceInternal.durationInternal = duration;\n        this.#sourceInternal.delayInternal = delay;\n        void this.#animationModel.agent.invoke_setTiming({ animationId: this.id(), duration, delay });\n    }\n    updateNodeStyle(duration, delay, node) {\n        let animationPrefix;\n        if (this.type() === \"CSSTransition\" /* Protocol.Animation.AnimationType.CSSTransition */) {\n            animationPrefix = 'transition-';\n        }\n        else if (this.type() === \"CSSAnimation\" /* Protocol.Animation.AnimationType.CSSAnimation */) {\n            animationPrefix = 'animation-';\n        }\n        else {\n            return;\n        }\n        if (!node.id) {\n            throw new Error('Node has no id');\n        }\n        const cssModel = node.domModel().cssModel();\n        cssModel.setEffectivePropertyValueForNode(node.id, animationPrefix + 'duration', duration + 'ms');\n        cssModel.setEffectivePropertyValueForNode(node.id, animationPrefix + 'delay', delay + 'ms');\n    }\n    async remoteObjectPromise() {\n        const payload = await this.#animationModel.agent.invoke_resolveAnimation({ animationId: this.id() });\n        if (!payload) {\n            return null;\n        }\n        return this.#animationModel.runtimeModel.createRemoteObject(payload.remoteObject);\n    }\n    cssId() {\n        return this.#payloadInternal.cssId || '';\n    }\n}\nexport class AnimationEffect {\n    #animationModel;\n    #payload; // Assertion is safe because `setPayload` call in `constructor` sets the value.\n    delayInternal; // Assertion is safe because `setPayload` call in `constructor` sets the value.\n    durationInternal; // Assertion is safe because `setPayload` call in `constructor` sets the value.\n    #keyframesRuleInternal;\n    #deferredNodeInternal;\n    constructor(animationModel, payload) {\n        this.#animationModel = animationModel;\n        this.setPayload(payload);\n    }\n    setPayload(payload) {\n        this.#payload = payload;\n        if (!this.#keyframesRuleInternal && payload.keyframesRule) {\n            this.#keyframesRuleInternal = new KeyframesRule(payload.keyframesRule);\n        }\n        else if (this.#keyframesRuleInternal && payload.keyframesRule) {\n            this.#keyframesRuleInternal.setPayload(payload.keyframesRule);\n        }\n        this.delayInternal = payload.delay;\n        this.durationInternal = payload.duration;\n    }\n    delay() {\n        return this.delayInternal;\n    }\n    endDelay() {\n        return this.#payload.endDelay;\n    }\n    iterations() {\n        // Animations with zero duration, zero delays and infinite iterations can't be shown.\n        if (!this.delay() && !this.endDelay() && !this.duration()) {\n            return 0;\n        }\n        return this.#payload.iterations || Infinity;\n    }\n    duration() {\n        return this.durationInternal;\n    }\n    direction() {\n        return this.#payload.direction;\n    }\n    fill() {\n        return this.#payload.fill;\n    }\n    node() {\n        if (!this.#deferredNodeInternal) {\n            this.#deferredNodeInternal =\n                new SDK.DOMModel.DeferredDOMNode(this.#animationModel.target(), this.backendNodeId());\n        }\n        return this.#deferredNodeInternal.resolvePromise();\n    }\n    deferredNode() {\n        return new SDK.DOMModel.DeferredDOMNode(this.#animationModel.target(), this.backendNodeId());\n    }\n    backendNodeId() {\n        return this.#payload.backendNodeId;\n    }\n    keyframesRule() {\n        return this.#keyframesRuleInternal || null;\n    }\n    easing() {\n        return this.#payload.easing;\n    }\n}\nexport class KeyframesRule {\n    #payload; // Assertion is safe because `setPayload` call in `constructor` sets the value.;\n    #keyframesInternal; // Assertion is safe because `setPayload` call in `constructor` sets the value.;\n    constructor(payload) {\n        this.setPayload(payload);\n    }\n    setPayload(payload) {\n        this.#payload = payload;\n        if (!this.#keyframesInternal) {\n            this.#keyframesInternal = this.#payload.keyframes.map(keyframeStyle => new KeyframeStyle(keyframeStyle));\n        }\n        else {\n            this.#payload.keyframes.forEach((keyframeStyle, index) => {\n                this.#keyframesInternal[index]?.setPayload(keyframeStyle);\n            });\n        }\n    }\n    name() {\n        return this.#payload.name;\n    }\n    keyframes() {\n        return this.#keyframesInternal;\n    }\n}\nexport class KeyframeStyle {\n    #payload; // Assertion is safe because `setPayload` call in `constructor` sets the value.\n    #offsetInternal; // Assertion is safe because `setPayload` call in `constructor` sets the value.\n    constructor(payload) {\n        this.setPayload(payload);\n    }\n    setPayload(payload) {\n        this.#payload = payload;\n        this.#offsetInternal = payload.offset;\n    }\n    offset() {\n        return this.#offsetInternal;\n    }\n    setOffset(offset) {\n        this.#offsetInternal = offset * 100 + '%';\n    }\n    offsetAsNumber() {\n        return parseFloat(this.#offsetInternal) / 100;\n    }\n    easing() {\n        return this.#payload.easing;\n    }\n}\nexport class AnimationGroup {\n    #animationModel;\n    #idInternal;\n    #scrollNodeInternal;\n    #animationsInternal;\n    #pausedInternal;\n    screenshotsInternal;\n    #screenshotImages;\n    constructor(animationModel, id, animations) {\n        this.#animationModel = animationModel;\n        this.#idInternal = id;\n        this.#animationsInternal = animations;\n        this.#pausedInternal = false;\n        this.screenshotsInternal = [];\n        this.#screenshotImages = [];\n    }\n    isScrollDriven() {\n        return Boolean(this.#animationsInternal[0]?.viewOrScrollTimeline());\n    }\n    id() {\n        return this.#idInternal;\n    }\n    animations() {\n        return this.#animationsInternal;\n    }\n    release() {\n        this.#animationModel.animationGroups.delete(this.id());\n        this.#animationModel.releaseAnimations(this.animationIds());\n    }\n    animationIds() {\n        function extractId(animation) {\n            return animation.id();\n        }\n        return this.#animationsInternal.map(extractId);\n    }\n    startTime() {\n        return this.#animationsInternal[0].startTime();\n    }\n    // For scroll driven animations, it returns the duration in pixels (i.e. after how many pixels of scroll the animation is going to end)\n    // For time animations, it returns milliseconds.\n    groupDuration() {\n        let duration = 0;\n        for (const anim of this.#animationsInternal) {\n            duration = Math.max(duration, anim.delayOrStartTime() + anim.iterationDuration());\n        }\n        return duration;\n    }\n    // For scroll driven animations, it returns the duration in pixels (i.e. after how many pixels of scroll the animation is going to end)\n    // For time animations, it returns milliseconds.\n    finiteDuration() {\n        let maxDuration = 0;\n        for (let i = 0; i < this.#animationsInternal.length; ++i) {\n            maxDuration = Math.max(maxDuration, this.#animationsInternal[i].finiteDuration());\n        }\n        return maxDuration;\n    }\n    scrollOrientation() {\n        const timeline = this.#animationsInternal[0]?.viewOrScrollTimeline();\n        if (!timeline) {\n            return null;\n        }\n        return timeline.axis;\n    }\n    async scrollNode() {\n        if (this.#scrollNodeInternal) {\n            return this.#scrollNodeInternal;\n        }\n        if (!this.isScrollDriven()) {\n            return null;\n        }\n        const sourceNodeId = this.#animationsInternal[0]?.viewOrScrollTimeline()?.sourceNodeId;\n        if (!sourceNodeId) {\n            return null;\n        }\n        const deferredScrollNode = new SDK.DOMModel.DeferredDOMNode(this.#animationModel.target(), sourceNodeId);\n        const scrollNode = await deferredScrollNode.resolvePromise();\n        if (!scrollNode) {\n            return null;\n        }\n        this.#scrollNodeInternal = new AnimationDOMNode(scrollNode);\n        return this.#scrollNodeInternal;\n    }\n    seekTo(currentTime) {\n        void this.#animationModel.agent.invoke_seekAnimations({ animations: this.animationIds(), currentTime });\n    }\n    paused() {\n        return this.#pausedInternal;\n    }\n    togglePause(paused) {\n        if (paused === this.#pausedInternal) {\n            return;\n        }\n        this.#pausedInternal = paused;\n        void this.#animationModel.agent.invoke_setPaused({ animations: this.animationIds(), paused });\n    }\n    currentTimePromise() {\n        let longestAnim = null;\n        for (const anim of this.#animationsInternal) {\n            if (!longestAnim || anim.endTime() > longestAnim.endTime()) {\n                longestAnim = anim;\n            }\n        }\n        if (!longestAnim) {\n            throw new Error('No longest animation found');\n        }\n        return this.#animationModel.agent.invoke_getCurrentTime({ id: longestAnim.id() })\n            .then(({ currentTime }) => currentTime || 0);\n    }\n    matches(group) {\n        function extractId(anim) {\n            const timelineId = (anim.viewOrScrollTimeline()?.sourceNodeId ?? '') + (anim.viewOrScrollTimeline()?.axis ?? '');\n            const regularId = anim.type() === \"WebAnimation\" /* Protocol.Animation.AnimationType.WebAnimation */ ? anim.type() + anim.id() : anim.cssId();\n            return regularId + timelineId;\n        }\n        if (this.#animationsInternal.length !== group.#animationsInternal.length) {\n            return false;\n        }\n        const left = this.#animationsInternal.map(extractId).sort();\n        const right = group.#animationsInternal.map(extractId).sort();\n        for (let i = 0; i < left.length; i++) {\n            if (left[i] !== right[i]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    shouldInclude(group) {\n        // We want to include the animations coming from the incoming group\n        // inside this group if they were to be grouped if the events came at the same time.\n        const [firstIncomingAnimation] = group.#animationsInternal;\n        const [firstAnimation] = this.#animationsInternal;\n        return shouldGroupAnimations(firstAnimation, firstIncomingAnimation);\n    }\n    appendAnimations(animations) {\n        this.#animationsInternal.push(...animations);\n    }\n    rebaseTo(group) {\n        this.#animationModel.releaseAnimations(this.animationIds());\n        this.#animationsInternal = group.#animationsInternal;\n        this.#scrollNodeInternal = undefined;\n    }\n    screenshots() {\n        for (let i = 0; i < this.screenshotsInternal.length; ++i) {\n            const image = new Image();\n            image.src = 'data:image/jpeg;base64,' + this.screenshotsInternal[i];\n            this.#screenshotImages.push(image);\n        }\n        this.screenshotsInternal = [];\n        return this.#screenshotImages;\n    }\n}\nexport class AnimationDispatcher {\n    #animationModel;\n    constructor(animationModel) {\n        this.#animationModel = animationModel;\n    }\n    animationCreated(_event) {\n        // Previously this event was used to batch the animations into groups\n        // and we were waiting for animationStarted events to be sent for\n        // all the created animations and until then we weren't creating any\n        // groups. This was allowing us to not miss any animations that were\n        // going to be in the same group. However, now we're not using this event\n        // to do batching and instead:\n        // * We debounce the flush calls so that if the animationStarted events\n        // for the same animation group come in different times; we create one\n        // group for them.\n        // * Even though an animation group is created and rendered for some animations\n        // that have the same startTime (or same timeline & scroll axis for SDAs), now\n        // whenever an `animationStarted` event comes we check whether there is a group\n        // we can add the related animation. If so, we add it and emit `animationGroupUpdated`\n        // event. So that, all the animations that were supposed to be in the same group\n        // will be in the same group.\n    }\n    animationCanceled({ id }) {\n        this.#animationModel.animationCanceled(id);\n    }\n    animationStarted({ animation }) {\n        void this.#animationModel.animationStarted(animation);\n    }\n    animationUpdated({ animation }) {\n        void this.#animationModel.animationUpdated(animation);\n    }\n}\nexport class ScreenshotCapture {\n    #requests;\n    #screenCaptureModel;\n    #animationModel;\n    #stopTimer;\n    #endTime;\n    #capturing;\n    constructor(animationModel, screenCaptureModel) {\n        this.#requests = [];\n        this.#screenCaptureModel = screenCaptureModel;\n        this.#animationModel = animationModel;\n        this.#animationModel.addEventListener(Events.ModelReset, this.stopScreencast, this);\n    }\n    captureScreenshots(duration, screenshots) {\n        const screencastDuration = Math.min(duration / this.#animationModel.playbackRate, 3000);\n        const endTime = screencastDuration + window.performance.now();\n        this.#requests.push({ endTime, screenshots });\n        if (!this.#endTime || endTime > this.#endTime) {\n            clearTimeout(this.#stopTimer);\n            this.#stopTimer = window.setTimeout(this.stopScreencast.bind(this), screencastDuration);\n            this.#endTime = endTime;\n        }\n        if (this.#capturing) {\n            return;\n        }\n        this.#capturing = true;\n        this.#screenCaptureModel.startScreencast(\"jpeg\" /* Protocol.Page.StartScreencastRequestFormat.Jpeg */, 80, undefined, 300, 2, this.screencastFrame.bind(this), _visible => { });\n    }\n    screencastFrame(base64Data, _metadata) {\n        function isAnimating(request) {\n            return request.endTime >= now;\n        }\n        if (!this.#capturing) {\n            return;\n        }\n        const now = window.performance.now();\n        this.#requests = this.#requests.filter(isAnimating);\n        for (const request of this.#requests) {\n            request.screenshots.push(base64Data);\n        }\n    }\n    stopScreencast() {\n        if (!this.#capturing) {\n            return;\n        }\n        this.#stopTimer = undefined;\n        this.#endTime = undefined;\n        this.#requests = [];\n        this.#capturing = false;\n        this.#screenCaptureModel.stopScreencast();\n    }\n}\nSDK.SDKModel.SDKModel.register(AnimationModel, { capabilities: 2 /* SDK.Target.Capability.DOM */, autostart: false });\n//# sourceMappingURL=AnimationModel.js.map","// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n// IMPORTANT: this file is auto generated. Please do not edit this file.\n/* istanbul ignore file */\nconst styles = new CSSStyleSheet();\nstyles.replaceSync(\n`/*\n * Copyright (c) 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\nimg {\n  max-height: 300px;\n  border-radius: 2px;\n}\n\n.animation-progress {\n  position: absolute;\n  height: 2px;\n  bottom: 0;\n  left: 0;\n  background: var(--legacy-selection-bg-color);\n}\n\n/*# sourceURL=animationScreenshotPopover.css */\n`);\n\nexport default styles;\n","// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as UI from '../../ui/legacy/legacy.js';\nimport animationScreenshotPopoverStyles from './animationScreenshotPopover.css.js';\nexport class AnimationScreenshotPopover extends UI.Widget.VBox {\n    #frames;\n    #rafId;\n    #currentFrame;\n    #progressBar;\n    #showFrame;\n    #endDelay;\n    constructor(images) {\n        super(true);\n        console.assert(images.length > 0);\n        this.contentElement.classList.add('animation-screenshot-popover');\n        this.#frames = images;\n        for (const image of images) {\n            this.contentElement.appendChild(image);\n            image.style.display = 'none';\n        }\n        this.#rafId = 0;\n        this.#currentFrame = 0;\n        this.#frames[0].style.display = 'block';\n        this.#progressBar = this.contentElement.createChild('div', 'animation-progress');\n    }\n    wasShown() {\n        this.#rafId = this.contentElement.window().requestAnimationFrame(this.changeFrame.bind(this));\n        this.registerCSSFiles([animationScreenshotPopoverStyles]);\n    }\n    willHide() {\n        this.contentElement.window().cancelAnimationFrame(this.#rafId);\n        this.#endDelay = undefined;\n    }\n    changeFrame() {\n        this.#rafId = this.contentElement.window().requestAnimationFrame(this.changeFrame.bind(this));\n        if (this.#endDelay) {\n            this.#endDelay--;\n            return;\n        }\n        this.#showFrame = !this.#showFrame;\n        if (!this.#showFrame) {\n            return;\n        }\n        const numFrames = this.#frames.length;\n        this.#frames[this.#currentFrame % numFrames].style.display = 'none';\n        this.#currentFrame++;\n        this.#frames[(this.#currentFrame) % numFrames].style.display = 'block';\n        if (this.#currentFrame % numFrames === numFrames - 1) {\n            this.#endDelay = 50;\n        }\n        this.#progressBar.style.width = (this.#currentFrame % numFrames + 1) / numFrames * 100 + '%';\n    }\n}\n//# sourceMappingURL=AnimationScreenshotPopover.js.map","// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n// IMPORTANT: this file is auto generated. Please do not edit this file.\n/* istanbul ignore file */\nconst styles = new CSSStyleSheet();\nstyles.replaceSync(\n`/*\n * Copyright (c) 2015 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n:host {\n  overflow: hidden;\n\n  --timeline-controls-width: 150px;\n}\n\n.animation-node-row {\n  width: 100%;\n  display: flex;\n  border-bottom: 1px dashed var(--sys-color-divider);\n}\n\n.animation-node-description {\n  padding-left: 8px;\n  overflow: hidden;\n  position: relative;\n  background-color: var(--sys-color-cdt-base-container);\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: flex-start;\n  white-space: nowrap;\n  flex: 0 0 var(--timeline-controls-width);\n  z-index: 1;\n}\n\n.animation-node-description > * {\n  flex: 0 0 auto;\n}\n\n.animation-timeline-row {\n  height: 32px;\n  position: relative;\n}\n\npath.animation-keyframe {\n  fill-opacity: 0.2;\n}\n\n.animation-node-selected path.animation-keyframe,\nsvg.animation-ui g:first-child:hover path.animation-keyframe {\n  fill-opacity: 0.4;\n}\n\nline.animation-line {\n  stroke-width: 2px;\n  stroke-linecap: round;\n  fill: none;\n}\n\nline.animation-delay-line {\n  stroke-width: 2px;\n  stroke-dasharray: 6, 4;\n}\n\nline.animation-delay-line.animation-fill {\n  stroke-dasharray: none;\n}\n\ncircle.animation-keyframe-point {\n  fill: var(--sys-color-cdt-base-container);\n}\n\ncircle.animation-endpoint,\ncircle.animation-keyframe-point {\n  stroke-width: 2px;\n  transition: transform 100ms cubic-bezier(0, 0, 0.2, 1);\n  transform: scale(1);\n  transform-box: fill-box;\n  transform-origin: 50% 50%;\n}\n\ncircle.animation-endpoint:active,\ncircle.animation-keyframe-point:active {\n  transform: scale(1);\n}\n\n.animation-ui circle.animation-endpoint:hover,\n.animation-ui circle.animation-keyframe-point:hover {\n  transform: scale(1.2);\n}\n\n.animation-name {\n  position: absolute;\n  top: 8px;\n  color: var(--sys-color-on-surface);\n  text-align: center;\n  margin-left: -8px;\n  white-space: nowrap;\n}\n\n.animation-timeline-toolbar-container {\n  display: flex;\n  background-color: var(--sys-color-cdt-base-container);\n  border-bottom: 1px solid var(--sys-color-divider);\n  flex: 0 0 auto;\n}\n\n.animation-timeline-toolbar {\n  display: inline-block;\n}\n\n.animation-timeline-header {\n  height: 28px;\n  border-bottom: 1px solid var(--sys-color-divider);\n  flex-shrink: 0;\n  display: flex;\n}\n\n.animation-timeline-header::after {\n  content: \"\";\n  height: calc(100% - 48px - 28px);\n  position: absolute;\n  width: var(--timeline-controls-width);\n  left: 0;\n  margin-top: 28px;\n  background-color: var(--sys-color-cdt-base-container);\n  z-index: 0;\n  border-right: 1px solid var(--sys-color-divider);\n}\n\n.animation-controls {\n  flex: 0 0 var(--timeline-controls-width);\n  position: relative;\n  display: flex;\n  justify-content: flex-end;\n  padding-right: 8px;\n}\n\n.animation-timeline-current-time {\n  flex: 0 0 auto;\n  line-height: 28px;\n  margin-right: 5px;\n}\n\n.animation-grid-header {\n  flex: 1 0 auto;\n  z-index: 2;\n}\n\n.animation-grid-header.scrubber-enabled {\n  cursor: pointer;\n}\n\n.animation-timeline-buffer,\n.animation-timeline-buffer-hint {\n  height: 48px;\n  flex: 0 0 auto;\n  border-bottom: 1px solid var(--sys-color-divider);\n  display: flex;\n  padding: 0 2px;\n}\n\n.animation-timeline-buffer:empty,\n.animation-timeline-buffer-hint {\n  display: none;\n}\n\n.animation-timeline-buffer:empty ~ .animation-timeline-buffer-hint {\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  z-index: 101;\n  display: flex;\n}\n\n.animation-time-overlay {\n  background-color: var(--sys-color-on-surface);\n  opacity: 5%;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  z-index: -1;\n}\n\n.animation-timeline-end > .animation-time-overlay {\n  visibility: hidden;\n}\n\n.animation-scrubber {\n  opacity: 100%;\n  position: absolute;\n  left: 10px;\n  height: 100%;\n  width: 100%;\n  top: 28px;\n  border-left: 1px solid var(--sys-color-error);\n  z-index: 2;\n}\n\n.animation-scrubber-line {\n  width: 11px;\n  background: linear-gradient(to right, transparent 5px, var(--sys-color-error) 5px, var(--sys-color-error) 6px, transparent 6px);\n  position: absolute;\n  top: -28px;\n  height: 28px;\n  left: -6px;\n  padding: 0 5px;\n  z-index: 3;\n}\n\n.animation-scrubber-head {\n  width: 7px;\n  height: 7px;\n  transform: rotate(45deg);\n  background: var(--sys-color-error);\n  position: absolute;\n  left: 2px;\n  top: 1px;\n  z-index: 4;\n}\n\n.grid-overflow-wrapper {\n  position: absolute;\n  left: calc(var(--timeline-controls-width) - 10px);\n  top: 76px;\n  z-index: 1;\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n}\n\nsvg.animation-timeline-grid {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  height: 100%;\n}\n\nrect.animation-timeline-grid-line {\n  fill: var(--sys-color-divider);\n}\n\n.animation-timeline-row > svg.animation-ui {\n  position: absolute;\n}\n\n.animation-node-timeline {\n  flex-grow: 1;\n}\n\n.animation-node-description > div {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  max-height: 100%;\n}\n\n.animation-node-removed {\n  filter: saturate(0);\n  cursor: not-allowed;\n}\n\n.animation-node-removed-overlay {\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  cursor: not-allowed;\n}\n\nsvg.animation-ui g:first-child {\n  opacity: 100%;\n}\n\nsvg.animation-ui circle:focus-visible,\nsvg.animation-ui path:focus-visible {\n  outline: 2px solid -webkit-focus-ring-color;\n}\n\n.animation-tail-iterations {\n  opacity: 50%;\n}\n\n.animation-keyframe-step line {\n  stroke-width: 2;\n  stroke-opacity: 0.3;\n}\n\ntext.animation-timeline-grid-label {\n  font-size: 10px;\n  fill: var(--sys-color-token-subtle);\n  text-anchor: middle;\n}\n\n@keyframes --full-opacity-for-screenshots-container {\n  from {\n    opacity: 100%;\n  }\n\n  to {\n    opacity: 100%;\n  }\n}\n\n.preview-ui-container {\n  position: relative;\n\n  & .screenshot-arrow {\n    background-image: var(--image-file-popoverArrows);\n    background-position: 0 76px;\n    width: 19px;\n    height: 19px;\n    position: absolute;\n    left: 6px;\n    top: -19px;\n    z-index: 100;\n    pointer-events: none;\n  }\n\n  & .screenshots-container {\n    position: absolute;\n    display: none;\n    opacity: 0%;\n    left: 6px;\n    top: 100%;\n    z-index: 100;\n    border: 1px solid transparent;\n    box-shadow: var(--drop-shadow);\n    border-radius: 2px;\n    max-width: 220px;\n    max-height: 220px;\n  }\n\n  & .screenshots-container.to-the-left {\n    left: unset;\n    right: 6px;\n  }\n\n  & .screenshots-container.to-the-left .screenshot-arrow {\n    left: unset;\n    right: 6px;\n  }\n\n  &:hover .screenshots-container:not(.no-screenshots) {\n    display: block;\n    animation-name: --full-opacity-for-screenshots-container;\n    animation-duration: 0s;\n    animation-delay: 0.2s; /* Show the screenshots after 0.2s delay */\n    animation-fill-mode: forwards;\n  }\n\n  &:hover .screenshots-container:not(.no-screenshots):hover {\n    display: none;\n  }\n\n  &:has(.selected):hover .screenshots-container:not(.no-screenshots) {\n    display: none;\n  }\n}\n\n.animation-timeline-rows,\n.animation-timeline-rows-hint {\n  flex-grow: 1;\n  overflow-y: auto;\n  z-index: 1;\n  overflow-x: hidden;\n}\n\n.animation-timeline-rows-hint {\n  display: none;\n}\n\n.animation-timeline-buffer:not(:empty) ~ .animation-timeline-rows:empty {\n  flex-grow: 0;\n}\n\n.animation-timeline-buffer:not(:empty) ~ .animation-timeline-rows:empty ~ .animation-timeline-rows-hint {\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: var(--timeline-controls-width);\n  padding: 10px;\n}\n\n.toolbar.animation-controls-toolbar {\n  flex: 0 0 auto;\n}\n\n.animation-node-row.animation-node-selected {\n  background-color: var(--sys-color-state-ripple-primary);\n}\n\n.animation-node-selected > .animation-node-description {\n  background-color: var(--sys-color-tonal-container);\n}\n\n.animation-buffer-preview {\n  height: 40px;\n  margin: 4px 2px;\n  background-color: var(--sys-color-neutral-container);\n  border: 1px solid transparent;\n  border-radius: 2px;\n  flex: 1 1;\n  padding: 4px;\n  max-width: 100px;\n  animation: newGroupAnim 200ms;\n  position: relative;\n}\n\n.animation-buffer-preview.no-animation {\n  animation: none;\n}\n\n.animation-buffer-preview .preview-icon {\n  position: absolute;\n  width: 14px;\n  height: 14px;\n  right: 1px;\n  bottom: 2px;\n  opacity: 60%;\n}\n\n.animation-buffer-preview-animation {\n  width: 100%;\n  height: 100%;\n  border-radius: 2px 0 0 2px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: var(--sys-color-tonal-container);\n  opacity: 0%;\n  border-right: 1px solid var(--sys-color-divider);\n}\n\n.animation-buffer-preview:focus-visible {\n  outline: -webkit-focus-ring-color auto 5px;\n}\n\n.animation-buffer-preview.selected .preview-icon {\n  opacity: 100%;\n}\n\n.animation-buffer-preview:not(.selected):focus-visible,\n.animation-buffer-preview:not(.selected):hover {\n  background-color: var(--sys-color-surface-variant);\n\n  & .preview-icon {\n    opacity: 80%;\n  }\n}\n\n.animation-buffer-preview.selected {\n  background-color: var(--sys-color-tonal-container);\n}\n\n.animation-paused {\n  align-items: center;\n  justify-content: center;\n  display: none;\n}\n\n.animation-paused::before,\n.animation-paused::after {\n  content: \"\";\n  background: var(--sys-color-cdt-base-container);\n  width: 7px;\n  height: 20px;\n  border-radius: 2px;\n  margin: 2px;\n  border: 1px solid var(--sys-color-divider);\n}\n\n.animation-buffer-preview.paused .animation-paused {\n  display: flex;\n}\n\n.animation-buffer-preview > svg > line {\n  stroke-width: 1px;\n}\n\n.animation-buffer-preview.selected > svg > line {\n  stroke: var(--sys-color-on-tonal-container) !important; /* stylelint-disable-line declaration-no-important */\n}\n\n@keyframes newGroupAnim {\n  from {\n    clip-path: polygon(0% 0%, 0% 100%, 50% 100%, 50% 0%);\n  }\n\n  to {\n    clip-path: polygon(0% 0%, 0% 100%, 100% 100%, 100% 0%);\n  }\n}\n\n.animation-playback-rate-control {\n  margin: 4px 0 4px 2px;\n  display: flex;\n  width: 120px;\n}\n\n.animation-playback-rate-button {\n  border-width: 1px;\n  border-style: solid;\n  border-color: var(--sys-color-tonal-outline);\n  border-right-width: 0;\n  color: var(--sys-color-on-surface);\n  display: inline-block;\n  margin-right: -1px;\n  padding: 1px 4px;\n  background-color: transparent;\n  flex: 1 0 auto;\n  text-align: center;\n}\n\n.animation-playback-rate-button:first-child {\n  border-radius: 4px 0 0 4px;\n}\n\n.animation-playback-rate-button:last-child {\n  border-radius: 0 4px 4px 0;\n  border-right-width: 1px;\n}\n\n.animation-playback-rate-button.selected {\n  color: var(--sys-color-on-tonal-container);\n  background-color: var(--sys-color-tonal-container);\n  border-color: var(--sys-color-tonal-container);\n  z-index: 1;\n}\n\n.animation-playback-rate-button.selected:focus-visible {\n  color: var(--sys-color-on-surface);\n}\n\n.animation-playback-rate-button:focus-visible {\n  outline: 2px solid var(--sys-color-primary);\n  outline-offset: 2px;\n}\n\n.animation-playback-rate-button:not(.selected):not([disabled]):hover {\n  background: var(--sys-color-state-hover-on-subtle);\n}\n\n.animation-playback-rate-button[disabled] {\n  background: unset;\n  border-color: var(--sys-color-state-disabled);\n  color: var(--sys-color-state-disabled);\n}\n\n.animation-remove-button {\n  position: absolute;\n  top: -3px;\n  right: -3px;\n  background: var(--sys-color-token-subtle);\n  border-radius: 12px;\n  border: 0;\n  height: 16px;\n  width: 16px;\n  z-index: 100;\n  display: none;\n  padding: 0;\n\n  & > devtools-icon {\n    height: 16px;\n    width: 16px;\n    color: var(--sys-color-cdt-base-container);\n  }\n\n  &:hover {\n    background-color: var(--sys-color-on-surface);\n  }\n}\n\n.animation-buffer-preview:hover .animation-remove-button {\n  display: flex;\n}\n\n.timeline-controls-resizer {\n  position: absolute;\n  width: 6px;\n  height: 100%;\n  left: var(--timeline-controls-width);\n  top: 104px;\n  z-index: 3;\n  /* We put this a bit to the left of the line to allow dragging\n  the delay point of the keyframes */\n  margin-left: -4px;\n}\n\n@media (forced-colors: active) {\n  .animation-playback-rate-button.selected,\n  .animation-playback-rate-button.selected:first-child,\n  .animation-playback-rate-button.selected:first-child:focus-visible,\n  .animation-playback-rate-button:focus-visible {\n    forced-color-adjust: none;\n    color: HighlightText;\n    background-color: Highlight;\n  }\n\n  .animation-node-description:focus-visible {\n    background-color: var(--sys-color-cdt-base-container);\n    forced-color-adjust: none;\n  }\n\n  .monospace {\n    forced-color-adjust: auto;\n  }\n}\n\n/*# sourceURL=animationTimeline.css */\n`);\n\nexport default styles;\n","// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\nimport { AnimationGroupPreviewUI } from './AnimationGroupPreviewUI.js';\nimport { AnimationModel, Events, } from './AnimationModel.js';\nimport { AnimationScreenshotPopover } from './AnimationScreenshotPopover.js';\nimport animationTimelineStyles from './animationTimeline.css.js';\nimport { AnimationUI } from './AnimationUI.js';\nconst UIStrings = {\n    /**\n     *@description Timeline hint text content in Animation Timeline of the Animation Inspector\n     */\n    selectAnEffectAboveToInspectAnd: 'Select an effect above to inspect and modify.',\n    /**\n     *@description Text to clear everything\n     */\n    clearAll: 'Clear all',\n    /**\n     *@description Tooltip text that appears when hovering over largeicon pause button in Animation Timeline of the Animation Inspector\n     */\n    pauseAll: 'Pause all',\n    /**\n     *@description Title of the playback rate button listbox\n     */\n    playbackRates: 'Playback rates',\n    /**\n     *@description Text in Animation Timeline of the Animation Inspector\n     *@example {50} PH1\n     */\n    playbackRatePlaceholder: '{PH1}%',\n    /**\n     *@description Text of an item that pause the running task\n     */\n    pause: 'Pause',\n    /**\n     *@description Button title in Animation Timeline of the Animation Inspector\n     *@example {50%} PH1\n     */\n    setSpeedToS: 'Set speed to {PH1}',\n    /**\n     *@description Title of Animation Previews listbox\n     */\n    animationPreviews: 'Animation previews',\n    /**\n     *@description Empty buffer hint text content in Animation Timeline of the Animation Inspector\n     */\n    waitingForAnimations: 'Waiting for animations...',\n    /**\n     *@description Tooltip text that appears when hovering over largeicon replay animation button in Animation Timeline of the Animation Inspector\n     */\n    replayTimeline: 'Replay timeline',\n    /**\n     *@description Text in Animation Timeline of the Animation Inspector\n     */\n    resumeAll: 'Resume all',\n    /**\n     *@description Title of control button in animation timeline of the animation inspector\n     */\n    playTimeline: 'Play timeline',\n    /**\n     *@description Title of control button in animation timeline of the animation inspector\n     */\n    pauseTimeline: 'Pause timeline',\n    /**\n     *@description Title of a specific Animation Preview\n     *@example {1} PH1\n     */\n    animationPreviewS: 'Animation Preview {PH1}',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/animation/AnimationTimeline.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst nodeUIsByNode = new WeakMap();\nconst playbackRates = new WeakMap();\nconst MIN_TIMELINE_CONTROLS_WIDTH = 120;\nconst DEFAULT_TIMELINE_CONTROLS_WIDTH = 150;\nconst MAX_TIMELINE_CONTROLS_WIDTH = 720;\nlet animationTimelineInstance;\nexport class AnimationTimeline extends UI.Widget.VBox {\n    #gridWrapper;\n    #grid;\n    #playbackRate;\n    #allPaused;\n    #screenshotPopovers = [];\n    #animationsContainer;\n    #playbackRateButtons;\n    #previewContainer;\n    #timelineScrubber;\n    #currentTime;\n    #clearButton;\n    #selectedGroup;\n    #renderQueue;\n    #defaultDuration;\n    #durationInternal;\n    #timelineControlsWidth;\n    #nodesMap;\n    #uiAnimations;\n    #groupBuffer;\n    #previewMap;\n    #animationsMap;\n    #timelineScrubberLine;\n    #pauseButton;\n    #controlButton;\n    #controlState;\n    #redrawing;\n    #cachedTimelineWidth;\n    #scrubberPlayer;\n    #gridOffsetLeft;\n    #originalScrubberTime;\n    #animationGroupPausedBeforeScrub;\n    #originalMousePosition;\n    #timelineControlsResizer;\n    #gridHeader;\n    #scrollListenerId;\n    #collectedGroups;\n    #createPreviewForCollectedGroupsThrottler = new Common.Throttler.Throttler(10);\n    #animationGroupUpdatedThrottler = new Common.Throttler.Throttler(10);\n    // We're only adding event listeners to the animation model when the panel is first shown.\n    #initialized = false;\n    constructor() {\n        super(true);\n        this.element.classList.add('animations-timeline');\n        this.element.setAttribute('jslog', `${VisualLogging.panel('animations').track({ resize: true })}`);\n        this.#timelineControlsResizer = this.contentElement.createChild('div', 'timeline-controls-resizer');\n        this.#gridWrapper = this.contentElement.createChild('div', 'grid-overflow-wrapper');\n        this.#grid = UI.UIUtils.createSVGChild(this.#gridWrapper, 'svg', 'animation-timeline-grid');\n        this.#playbackRate = 1;\n        this.#allPaused = false;\n        this.#animationGroupPausedBeforeScrub = false;\n        this.createHeader();\n        this.#animationsContainer = this.contentElement.createChild('div', 'animation-timeline-rows');\n        this.#animationsContainer.setAttribute('jslog', `${VisualLogging.section('animations')}`);\n        const timelineHint = this.contentElement.createChild('div', 'animation-timeline-rows-hint');\n        timelineHint.textContent = i18nString(UIStrings.selectAnEffectAboveToInspectAnd);\n        /** @const */ this.#defaultDuration = 100;\n        this.#durationInternal = this.#defaultDuration;\n        this.#nodesMap = new Map();\n        this.#uiAnimations = [];\n        this.#groupBuffer = [];\n        this.#collectedGroups = [];\n        this.#previewMap = new Map();\n        this.#animationsMap = new Map();\n        this.#timelineControlsWidth = DEFAULT_TIMELINE_CONTROLS_WIDTH;\n        this.element.style.setProperty('--timeline-controls-width', `${this.#timelineControlsWidth}px`);\n        SDK.TargetManager.TargetManager.instance().addModelListener(SDK.DOMModel.DOMModel, SDK.DOMModel.Events.NodeRemoved, ev => this.markNodeAsRemoved(ev.data.node), this, { scoped: true });\n        SDK.TargetManager.TargetManager.instance().observeModels(AnimationModel, this, { scoped: true });\n        UI.Context.Context.instance().addFlavorChangeListener(SDK.DOMModel.DOMNode, this.nodeChanged, this);\n        this.#setupTimelineControlsResizer();\n    }\n    static instance(opts) {\n        if (!animationTimelineInstance || opts?.forceNew) {\n            animationTimelineInstance = new AnimationTimeline();\n        }\n        return animationTimelineInstance;\n    }\n    #setupTimelineControlsResizer() {\n        let resizeOriginX = undefined;\n        UI.UIUtils.installDragHandle(this.#timelineControlsResizer, (ev) => {\n            resizeOriginX = ev.clientX;\n            return true;\n        }, (ev) => {\n            if (resizeOriginX === undefined) {\n                return;\n            }\n            const newWidth = this.#timelineControlsWidth + ev.clientX - resizeOriginX;\n            this.#timelineControlsWidth =\n                Math.min(Math.max(newWidth, MIN_TIMELINE_CONTROLS_WIDTH), MAX_TIMELINE_CONTROLS_WIDTH);\n            resizeOriginX = ev.clientX;\n            this.element.style.setProperty('--timeline-controls-width', this.#timelineControlsWidth + 'px');\n            this.onResize();\n        }, () => {\n            resizeOriginX = undefined;\n        }, 'ew-resize');\n    }\n    get previewMap() {\n        return this.#previewMap;\n    }\n    get uiAnimations() {\n        return this.#uiAnimations;\n    }\n    get groupBuffer() {\n        return this.#groupBuffer;\n    }\n    wasShown() {\n        if (this.#initialized) {\n            return;\n        }\n        for (const animationModel of SDK.TargetManager.TargetManager.instance().models(AnimationModel, { scoped: true })) {\n            this.addEventListeners(animationModel);\n        }\n        this.registerCSSFiles([animationTimelineStyles]);\n        this.#initialized = true;\n    }\n    modelAdded(animationModel) {\n        if (this.isShowing()) {\n            this.addEventListeners(animationModel);\n        }\n    }\n    modelRemoved(animationModel) {\n        this.removeEventListeners(animationModel);\n    }\n    addEventListeners(animationModel) {\n        void animationModel.ensureEnabled();\n        animationModel.addEventListener(Events.AnimationGroupStarted, this.animationGroupStarted, this);\n        animationModel.addEventListener(Events.AnimationGroupUpdated, this.animationGroupUpdated, this);\n        animationModel.addEventListener(Events.ModelReset, this.reset, this);\n    }\n    removeEventListeners(animationModel) {\n        animationModel.removeEventListener(Events.AnimationGroupStarted, this.animationGroupStarted, this);\n        animationModel.removeEventListener(Events.AnimationGroupUpdated, this.animationGroupUpdated, this);\n        animationModel.removeEventListener(Events.ModelReset, this.reset, this);\n    }\n    nodeChanged() {\n        for (const nodeUI of this.#nodesMap.values()) {\n            nodeUI.nodeChanged();\n        }\n    }\n    createScrubber() {\n        this.#timelineScrubber = document.createElement('div');\n        this.#timelineScrubber.classList.add('animation-scrubber');\n        this.#timelineScrubber.classList.add('hidden');\n        this.#timelineScrubberLine = this.#timelineScrubber.createChild('div', 'animation-scrubber-line');\n        this.#timelineScrubberLine.createChild('div', 'animation-scrubber-head');\n        this.#timelineScrubber.createChild('div', 'animation-time-overlay');\n        return this.#timelineScrubber;\n    }\n    createHeader() {\n        const toolbarContainer = this.contentElement.createChild('div', 'animation-timeline-toolbar-container');\n        toolbarContainer.setAttribute('jslog', `${VisualLogging.toolbar()}`);\n        const topToolbar = new UI.Toolbar.Toolbar('animation-timeline-toolbar', toolbarContainer);\n        this.#clearButton =\n            new UI.Toolbar.ToolbarButton(i18nString(UIStrings.clearAll), 'clear', undefined, 'animations.clear');\n        this.#clearButton.addEventListener(\"Click\" /* UI.Toolbar.ToolbarButton.Events.CLICK */, () => {\n            Host.userMetrics.actionTaken(Host.UserMetrics.Action.AnimationGroupsCleared);\n            this.reset();\n        });\n        topToolbar.appendToolbarItem(this.#clearButton);\n        topToolbar.appendSeparator();\n        this.#pauseButton =\n            new UI.Toolbar.ToolbarToggle(i18nString(UIStrings.pauseAll), 'pause', 'resume', 'animations.pause-resume-all');\n        this.#pauseButton.addEventListener(\"Click\" /* UI.Toolbar.ToolbarButton.Events.CLICK */, () => {\n            this.togglePauseAll();\n        });\n        topToolbar.appendToolbarItem(this.#pauseButton);\n        const playbackRateControl = toolbarContainer.createChild('div', 'animation-playback-rate-control');\n        playbackRateControl.addEventListener('keydown', this.handlePlaybackRateControlKeyDown.bind(this));\n        UI.ARIAUtils.markAsListBox(playbackRateControl);\n        UI.ARIAUtils.setLabel(playbackRateControl, i18nString(UIStrings.playbackRates));\n        this.#playbackRateButtons = [];\n        for (const playbackRate of GlobalPlaybackRates) {\n            const button = playbackRateControl.createChild('button', 'animation-playback-rate-button');\n            button.textContent = playbackRate ? i18nString(UIStrings.playbackRatePlaceholder, { PH1: playbackRate * 100 }) :\n                i18nString(UIStrings.pause);\n            button.setAttribute('jslog', `${VisualLogging.action().context(`animations.playback-rate-${playbackRate * 100}`).track({\n                click: true,\n                keydown: 'ArrowUp|ArrowDown|ArrowLeft|ArrowRight',\n            })}`);\n            playbackRates.set(button, playbackRate);\n            button.addEventListener('click', this.setPlaybackRate.bind(this, playbackRate));\n            UI.ARIAUtils.markAsOption(button);\n            UI.Tooltip.Tooltip.install(button, i18nString(UIStrings.setSpeedToS, { PH1: button.textContent }));\n            button.tabIndex = -1;\n            this.#playbackRateButtons.push(button);\n        }\n        this.updatePlaybackControls();\n        this.#previewContainer = this.contentElement.createChild('div', 'animation-timeline-buffer');\n        this.#previewContainer.setAttribute('jslog', `${VisualLogging.section('film-strip')}`);\n        UI.ARIAUtils.markAsListBox(this.#previewContainer);\n        UI.ARIAUtils.setLabel(this.#previewContainer, i18nString(UIStrings.animationPreviews));\n        const emptyBufferHint = this.contentElement.createChild('div', 'animation-timeline-buffer-hint');\n        emptyBufferHint.textContent = i18nString(UIStrings.waitingForAnimations);\n        const container = this.contentElement.createChild('div', 'animation-timeline-header');\n        const controls = container.createChild('div', 'animation-controls');\n        this.#currentTime = controls.createChild('div', 'animation-timeline-current-time monospace');\n        const toolbar = new UI.Toolbar.Toolbar('animation-controls-toolbar', controls);\n        this.#controlButton = new UI.Toolbar.ToolbarButton(i18nString(UIStrings.replayTimeline), 'replay', undefined, 'animations.play-replay-pause-animation-group');\n        this.#controlButton.element.classList.add('toolbar-state-on');\n        this.#controlState = \"replay-outline\" /* ControlState.REPLAY */;\n        this.#controlButton.addEventListener(\"Click\" /* UI.Toolbar.ToolbarButton.Events.CLICK */, this.controlButtonToggle.bind(this));\n        toolbar.appendToolbarItem(this.#controlButton);\n        this.#gridHeader = container.createChild('div', 'animation-grid-header');\n        this.#gridHeader.setAttribute('jslog', `${VisualLogging.timeline('animations.grid-header').track({ drag: true, click: true })}`);\n        UI.UIUtils.installDragHandle(this.#gridHeader, this.scrubberDragStart.bind(this), this.scrubberDragMove.bind(this), this.scrubberDragEnd.bind(this), null);\n        this.#gridWrapper.appendChild(this.createScrubber());\n        this.clearCurrentTimeText();\n        return container;\n    }\n    handlePlaybackRateControlKeyDown(event) {\n        const keyboardEvent = event;\n        switch (keyboardEvent.key) {\n            case 'ArrowLeft':\n            case 'ArrowUp':\n                this.focusNextPlaybackRateButton(event.target, /* focusPrevious */ true);\n                break;\n            case 'ArrowRight':\n            case 'ArrowDown':\n                this.focusNextPlaybackRateButton(event.target);\n                break;\n        }\n    }\n    focusNextPlaybackRateButton(target, focusPrevious) {\n        const button = target;\n        const currentIndex = this.#playbackRateButtons.indexOf(button);\n        const nextIndex = focusPrevious ? currentIndex - 1 : currentIndex + 1;\n        if (nextIndex < 0 || nextIndex >= this.#playbackRateButtons.length) {\n            return;\n        }\n        const nextButton = this.#playbackRateButtons[nextIndex];\n        nextButton.tabIndex = 0;\n        nextButton.focus();\n        if (target) {\n            target.tabIndex = -1;\n        }\n    }\n    togglePauseAll() {\n        this.#allPaused = !this.#allPaused;\n        Host.userMetrics.actionTaken(this.#allPaused ? Host.UserMetrics.Action.AnimationsPaused : Host.UserMetrics.Action.AnimationsResumed);\n        this.setPlaybackRate(this.#playbackRate);\n        if (this.#pauseButton) {\n            this.#pauseButton.setTitle(this.#allPaused ? i18nString(UIStrings.resumeAll) : i18nString(UIStrings.pauseAll));\n        }\n    }\n    setPlaybackRate(playbackRate) {\n        if (playbackRate !== this.#playbackRate) {\n            Host.userMetrics.animationPlaybackRateChanged(playbackRate === 0.1 ? 2 /* Host.UserMetrics.AnimationsPlaybackRate.PERCENT_10 */ :\n                playbackRate === 0.25 ? 1 /* Host.UserMetrics.AnimationsPlaybackRate.PERCENT_25 */ :\n                    playbackRate === 1 ? 0 /* Host.UserMetrics.AnimationsPlaybackRate.PERCENT_100 */ :\n                        3 /* Host.UserMetrics.AnimationsPlaybackRate.OTHER */);\n        }\n        this.#playbackRate = playbackRate;\n        for (const animationModel of SDK.TargetManager.TargetManager.instance().models(AnimationModel, { scoped: true })) {\n            animationModel.setPlaybackRate(this.#allPaused ? 0 : this.#playbackRate);\n        }\n        Host.userMetrics.actionTaken(Host.UserMetrics.Action.AnimationsPlaybackRateChanged);\n        if (this.#scrubberPlayer) {\n            this.#scrubberPlayer.playbackRate = this.effectivePlaybackRate();\n        }\n        this.updatePlaybackControls();\n    }\n    updatePlaybackControls() {\n        for (const button of this.#playbackRateButtons) {\n            const selected = this.#playbackRate === playbackRates.get(button);\n            button.classList.toggle('selected', selected);\n            button.tabIndex = selected ? 0 : -1;\n        }\n    }\n    controlButtonToggle() {\n        if (this.#controlState === \"play-outline\" /* ControlState.PLAY */) {\n            this.togglePause(false);\n        }\n        else if (this.#controlState === \"replay-outline\" /* ControlState.REPLAY */) {\n            Host.userMetrics.actionTaken(Host.UserMetrics.Action.AnimationGroupReplayed);\n            this.replay();\n        }\n        else {\n            this.togglePause(true);\n        }\n    }\n    updateControlButton() {\n        if (!this.#controlButton) {\n            return;\n        }\n        this.#controlButton.setEnabled(Boolean(this.#selectedGroup) && this.hasAnimationGroupActiveNodes() && !this.#selectedGroup?.isScrollDriven());\n        if (this.#selectedGroup && this.#selectedGroup.paused()) {\n            this.#controlState = \"play-outline\" /* ControlState.PLAY */;\n            this.#controlButton.element.classList.toggle('toolbar-state-on', true);\n            this.#controlButton.setTitle(i18nString(UIStrings.playTimeline));\n            this.#controlButton.setGlyph('play');\n        }\n        else if (!this.#scrubberPlayer || !this.#scrubberPlayer.currentTime ||\n            typeof this.#scrubberPlayer.currentTime !== 'number' || this.#scrubberPlayer.currentTime >= this.duration()) {\n            this.#controlState = \"replay-outline\" /* ControlState.REPLAY */;\n            this.#controlButton.element.classList.toggle('toolbar-state-on', true);\n            this.#controlButton.setTitle(i18nString(UIStrings.replayTimeline));\n            this.#controlButton.setGlyph('replay');\n        }\n        else {\n            this.#controlState = \"pause-outline\" /* ControlState.PAUSE */;\n            this.#controlButton.element.classList.toggle('toolbar-state-on', false);\n            this.#controlButton.setTitle(i18nString(UIStrings.pauseTimeline));\n            this.#controlButton.setGlyph('pause');\n        }\n    }\n    effectivePlaybackRate() {\n        return (this.#allPaused || (this.#selectedGroup && this.#selectedGroup.paused())) ? 0 : this.#playbackRate;\n    }\n    togglePause(pause) {\n        if (this.#selectedGroup) {\n            this.#selectedGroup.togglePause(pause);\n            const preview = this.#previewMap.get(this.#selectedGroup);\n            if (preview) {\n                preview.element.classList.toggle('paused', pause);\n            }\n        }\n        if (this.#scrubberPlayer) {\n            this.#scrubberPlayer.playbackRate = this.effectivePlaybackRate();\n        }\n        this.updateControlButton();\n    }\n    replay() {\n        if (!this.#selectedGroup || !this.hasAnimationGroupActiveNodes() || this.#selectedGroup.isScrollDriven()) {\n            return;\n        }\n        this.#selectedGroup.seekTo(0);\n        this.animateTime(0);\n        this.updateControlButton();\n    }\n    duration() {\n        return this.#durationInternal;\n    }\n    setDuration(duration) {\n        this.#durationInternal = duration;\n        this.scheduleRedraw();\n    }\n    clearTimeline() {\n        if (this.#selectedGroup && this.#scrollListenerId) {\n            void this.#selectedGroup.scrollNode().then((node) => {\n                void node?.removeScrollEventListener(this.#scrollListenerId);\n                this.#scrollListenerId = undefined;\n            });\n        }\n        this.#uiAnimations = [];\n        this.#nodesMap.clear();\n        this.#animationsMap.clear();\n        this.#animationsContainer.removeChildren();\n        this.#durationInternal = this.#defaultDuration;\n        this.#timelineScrubber.classList.add('hidden');\n        this.#gridHeader.classList.remove('scrubber-enabled');\n        this.#selectedGroup = null;\n        if (this.#scrubberPlayer) {\n            this.#scrubberPlayer.cancel();\n        }\n        this.#scrubberPlayer = undefined;\n        this.clearCurrentTimeText();\n        this.updateControlButton();\n    }\n    reset() {\n        this.clearTimeline();\n        this.setPlaybackRate(this.#playbackRate);\n        for (const group of this.#groupBuffer) {\n            group.release();\n        }\n        this.#groupBuffer = [];\n        this.clearPreviews();\n        this.renderGrid();\n    }\n    animationGroupStarted({ data }) {\n        this.addAnimationGroup(data);\n    }\n    scheduledRedrawAfterAnimationGroupUpdatedForTest() {\n    }\n    animationGroupUpdated({ data: group }) {\n        void this.#animationGroupUpdatedThrottler.schedule(async () => {\n            const preview = this.#previewMap.get(group);\n            if (preview) {\n                preview.replay();\n            }\n            if (this.#selectedGroup !== group) {\n                return;\n            }\n            if (group.isScrollDriven()) {\n                const animationNode = await group.scrollNode();\n                if (animationNode) {\n                    const scrollRange = group.scrollOrientation() === \"vertical\" /* Protocol.DOM.ScrollOrientation.Vertical */ ?\n                        await animationNode.verticalScrollRange() :\n                        await animationNode.horizontalScrollRange();\n                    const scrollOffset = group.scrollOrientation() === \"vertical\" /* Protocol.DOM.ScrollOrientation.Vertical */ ?\n                        await animationNode.scrollTop() :\n                        await animationNode.scrollLeft();\n                    if (scrollRange !== null) {\n                        this.setDuration(scrollRange);\n                    }\n                    if (scrollOffset !== null) {\n                        this.setCurrentTimeText(scrollOffset);\n                        this.setTimelineScrubberPosition(scrollOffset);\n                    }\n                }\n            }\n            else {\n                this.setDuration(group.finiteDuration());\n            }\n            this.updateControlButton();\n            this.scheduleRedraw();\n            this.scheduledRedrawAfterAnimationGroupUpdatedForTest();\n        });\n    }\n    clearPreviews() {\n        this.#previewMap.clear();\n        this.#screenshotPopovers.forEach(popover => {\n            popover.detach();\n        });\n        this.#previewContainer.removeChildren();\n        this.#screenshotPopovers = [];\n    }\n    createPreview(group) {\n        const preview = new AnimationGroupPreviewUI(group);\n        const previewUiContainer = document.createElement('div');\n        previewUiContainer.classList.add('preview-ui-container');\n        previewUiContainer.appendChild(preview.element);\n        const screenshotsContainer = document.createElement('div');\n        screenshotsContainer.classList.add('screenshots-container', 'no-screenshots');\n        screenshotsContainer.createChild('span', 'screenshot-arrow');\n        // After the view is shown on hover, position it if it is out of bounds.\n        screenshotsContainer.addEventListener('animationend', () => {\n            const { right, left, width } = screenshotsContainer.getBoundingClientRect();\n            // Render to the left if it is not getting out of bounds when rendered on the left.\n            if (right > window.innerWidth && (left - width) >= 0) {\n                screenshotsContainer.classList.add('to-the-left');\n            }\n        });\n        previewUiContainer.appendChild(screenshotsContainer);\n        this.#groupBuffer.push(group);\n        this.#previewMap.set(group, preview);\n        this.#previewContainer.appendChild(previewUiContainer);\n        preview.removeButton().addEventListener('click', this.removeAnimationGroup.bind(this, group));\n        preview.element.addEventListener('click', this.selectAnimationGroup.bind(this, group));\n        preview.element.addEventListener('keydown', this.handleAnimationGroupKeyDown.bind(this, group));\n        preview.element.addEventListener('mouseover', () => {\n            const screenshots = group.screenshots();\n            if (!screenshots.length) {\n                return;\n            }\n            screenshotsContainer.classList.remove('no-screenshots');\n            const createAndShowScreenshotPopover = () => {\n                const screenshotPopover = new AnimationScreenshotPopover(screenshots);\n                // This is needed for clearing out the widgets\n                this.#screenshotPopovers.push(screenshotPopover);\n                screenshotPopover.show(screenshotsContainer);\n            };\n            if (!screenshots[0].complete) {\n                screenshots[0].onload = createAndShowScreenshotPopover;\n            }\n            else {\n                createAndShowScreenshotPopover();\n            }\n        }, { once: true });\n        UI.ARIAUtils.setLabel(preview.element, i18nString(UIStrings.animationPreviewS, { PH1: this.#groupBuffer.indexOf(group) + 1 }));\n        UI.ARIAUtils.markAsOption(preview.element);\n        if (this.#previewMap.size === 1) {\n            const preview = this.#previewMap.get(this.#groupBuffer[0]);\n            if (preview) {\n                preview.element.tabIndex = 0;\n            }\n        }\n    }\n    previewsCreatedForTest() {\n    }\n    createPreviewForCollectedGroups() {\n        this.#collectedGroups.sort((a, b) => {\n            // Scroll driven animations are rendered first.\n            if (a.isScrollDriven() && !b.isScrollDriven()) {\n                return -1;\n            }\n            if (!a.isScrollDriven() && b.isScrollDriven()) {\n                return 1;\n            }\n            // Then compare the start times for the same type of animations.\n            if (a.startTime() !== b.startTime()) {\n                return a.startTime() - b.startTime();\n            }\n            // If the start times are the same, the one with the more animations take precedence.\n            return a.animations.length - b.animations.length;\n        });\n        for (const group of this.#collectedGroups) {\n            this.createPreview(group);\n        }\n        this.#collectedGroups = [];\n        this.previewsCreatedForTest();\n    }\n    addAnimationGroup(group) {\n        const previewGroup = this.#previewMap.get(group);\n        if (previewGroup) {\n            if (this.#selectedGroup === group) {\n                this.syncScrubber();\n            }\n            else {\n                previewGroup.replay();\n            }\n            return;\n        }\n        this.#groupBuffer.sort((left, right) => left.startTime() - right.startTime());\n        // Discard oldest groups from buffer if necessary\n        const groupsToDiscard = [];\n        const bufferSize = this.width() / 50;\n        while (this.#groupBuffer.length > bufferSize) {\n            const toDiscard = this.#groupBuffer.splice(this.#groupBuffer[0] === this.#selectedGroup ? 1 : 0, 1);\n            groupsToDiscard.push(toDiscard[0]);\n        }\n        for (const g of groupsToDiscard) {\n            const discardGroup = this.#previewMap.get(g);\n            if (!discardGroup) {\n                continue;\n            }\n            discardGroup.element.remove();\n            this.#previewMap.delete(g);\n            g.release();\n        }\n        // Batch creating preview for arrivals happening closely together to ensure\n        // stable UI sorting in the preview container.\n        this.#collectedGroups.push(group);\n        void this.#createPreviewForCollectedGroupsThrottler.schedule(() => Promise.resolve(this.createPreviewForCollectedGroups()));\n    }\n    handleAnimationGroupKeyDown(group, event) {\n        switch (event.key) {\n            case 'Backspace':\n            case 'Delete':\n                this.removeAnimationGroup(group, event);\n                break;\n            case 'ArrowLeft':\n            case 'ArrowUp':\n                this.focusNextGroup(group, /* target */ event.target, /* focusPrevious */ true);\n                break;\n            case 'ArrowRight':\n            case 'ArrowDown':\n                this.focusNextGroup(group, /* target */ event.target);\n        }\n    }\n    focusNextGroup(group, target, focusPrevious) {\n        const currentGroupIndex = this.#groupBuffer.indexOf(group);\n        const nextIndex = focusPrevious ? currentGroupIndex - 1 : currentGroupIndex + 1;\n        if (nextIndex < 0 || nextIndex >= this.#groupBuffer.length) {\n            return;\n        }\n        const preview = this.#previewMap.get(this.#groupBuffer[nextIndex]);\n        if (preview) {\n            preview.element.tabIndex = 0;\n            preview.element.focus();\n        }\n        if (target) {\n            target.tabIndex = -1;\n        }\n    }\n    removeAnimationGroup(group, event) {\n        const currentGroupIndex = this.#groupBuffer.indexOf(group);\n        Platform.ArrayUtilities.removeElement(this.#groupBuffer, group);\n        const previewGroup = this.#previewMap.get(group);\n        if (previewGroup) {\n            previewGroup.element.remove();\n        }\n        this.#previewMap.delete(group);\n        group.release();\n        event.consume(true);\n        if (this.#selectedGroup === group) {\n            this.clearTimeline();\n            this.renderGrid();\n        }\n        const groupLength = this.#groupBuffer.length;\n        if (groupLength === 0) {\n            this.#clearButton.element.focus();\n            return;\n        }\n        const nextGroup = currentGroupIndex >= this.#groupBuffer.length ?\n            this.#previewMap.get(this.#groupBuffer[this.#groupBuffer.length - 1]) :\n            this.#previewMap.get(this.#groupBuffer[currentGroupIndex]);\n        if (nextGroup) {\n            nextGroup.element.tabIndex = 0;\n            nextGroup.element.focus();\n        }\n    }\n    clearCurrentTimeText() {\n        this.#currentTime.textContent = '';\n    }\n    setCurrentTimeText(time) {\n        if (!this.#selectedGroup) {\n            return;\n        }\n        this.#currentTime.textContent =\n            this.#selectedGroup?.isScrollDriven() ? `${time.toFixed(0)}px` : i18n.TimeUtilities.millisToString(time);\n    }\n    async selectAnimationGroup(group) {\n        if (this.#selectedGroup === group) {\n            this.togglePause(false);\n            this.replay();\n            return;\n        }\n        this.clearTimeline();\n        this.#selectedGroup = group;\n        this.#previewMap.forEach((previewUI, group) => {\n            previewUI.element.classList.toggle('selected', this.#selectedGroup === group);\n        });\n        if (group.isScrollDriven()) {\n            const animationNode = await group.scrollNode();\n            if (!animationNode) {\n                throw new Error('Scroll container is not found for the scroll driven animation');\n            }\n            const scrollRange = group.scrollOrientation() === \"vertical\" /* Protocol.DOM.ScrollOrientation.Vertical */ ?\n                await animationNode.verticalScrollRange() :\n                await animationNode.horizontalScrollRange();\n            const scrollOffset = group.scrollOrientation() === \"vertical\" /* Protocol.DOM.ScrollOrientation.Vertical */ ?\n                await animationNode.scrollTop() :\n                await animationNode.scrollLeft();\n            if (typeof scrollRange !== 'number' || typeof scrollOffset !== 'number') {\n                throw new Error('Scroll range or scroll offset is not resolved for the scroll driven animation');\n            }\n            this.#scrollListenerId = await animationNode.addScrollEventListener(({ scrollTop, scrollLeft }) => {\n                const offset = group.scrollOrientation() === \"vertical\" /* Protocol.DOM.ScrollOrientation.Vertical */ ? scrollTop : scrollLeft;\n                this.setCurrentTimeText(offset);\n                this.setTimelineScrubberPosition(offset);\n            });\n            this.setDuration(scrollRange);\n            this.setCurrentTimeText(scrollOffset);\n            this.setTimelineScrubberPosition(scrollOffset);\n            this.#playbackRateButtons.forEach(button => {\n                button.setAttribute('disabled', 'true');\n            });\n            if (this.#pauseButton) {\n                this.#pauseButton.setEnabled(false);\n            }\n        }\n        else {\n            this.setDuration(Math.max(500, group.finiteDuration() + 100));\n            this.#playbackRateButtons.forEach(button => {\n                button.removeAttribute('disabled');\n            });\n            if (this.#pauseButton) {\n                this.#pauseButton.setEnabled(true);\n            }\n        }\n        // Wait for all animations to be added and nodes to be resolved\n        // until we schedule a redraw.\n        await Promise.all(group.animations().map(anim => this.addAnimation(anim)));\n        this.scheduleRedraw();\n        this.togglePause(false);\n        this.replay();\n        if (this.hasAnimationGroupActiveNodes()) {\n            this.#timelineScrubber.classList.remove('hidden');\n            this.#gridHeader.classList.add('scrubber-enabled');\n        }\n        Host.userMetrics.actionTaken(Host.UserMetrics.Action.AnimationGroupSelected);\n        if (this.#selectedGroup.isScrollDriven()) {\n            Host.userMetrics.actionTaken(Host.UserMetrics.Action.ScrollDrivenAnimationGroupSelected);\n        }\n        this.animationGroupSelectedForTest();\n    }\n    animationGroupSelectedForTest() {\n    }\n    async addAnimation(animation) {\n        let nodeUI = this.#nodesMap.get(animation.source().backendNodeId());\n        if (!nodeUI) {\n            nodeUI = new NodeUI(animation.source());\n            this.#animationsContainer.appendChild(nodeUI.element);\n            this.#nodesMap.set(animation.source().backendNodeId(), nodeUI);\n        }\n        const nodeRow = nodeUI.createNewRow();\n        const uiAnimation = new AnimationUI(animation, this, nodeRow);\n        const node = await animation.source().deferredNode().resolvePromise();\n        uiAnimation.setNode(node);\n        if (node && nodeUI) {\n            nodeUI.nodeResolved(node);\n            nodeUIsByNode.set(node, nodeUI);\n        }\n        this.#uiAnimations.push(uiAnimation);\n        this.#animationsMap.set(animation.id(), animation);\n    }\n    markNodeAsRemoved(node) {\n        nodeUIsByNode.get(node)?.nodeRemoved();\n        // Mark nodeUIs of pseudo elements of the node as removed for instance, for view transitions.\n        for (const pseudoElements of node.pseudoElements().values()) {\n            pseudoElements.forEach(pseudoElement => this.markNodeAsRemoved(pseudoElement));\n        }\n        // Mark nodeUIs of children as node removed.\n        node.children()?.forEach(child => {\n            this.markNodeAsRemoved(child);\n        });\n        // If the user already has a selected animation group and\n        // some of the nodes are removed, we check whether all the nodes\n        // are removed for the currently selected animation. If that's the case\n        // we remove the scrubber and update control button to be disabled.\n        if (!this.hasAnimationGroupActiveNodes()) {\n            this.#gridHeader.classList.remove('scrubber-enabled');\n            this.#timelineScrubber.classList.add('hidden');\n            this.#scrubberPlayer?.cancel();\n            this.#scrubberPlayer = undefined;\n            this.clearCurrentTimeText();\n            this.updateControlButton();\n        }\n    }\n    hasAnimationGroupActiveNodes() {\n        for (const nodeUI of this.#nodesMap.values()) {\n            if (nodeUI.hasActiveNode()) {\n                return true;\n            }\n        }\n        return false;\n    }\n    renderGrid() {\n        const isScrollDriven = this.#selectedGroup?.isScrollDriven();\n        // For scroll driven animations, show divider lines for each 10% progres.\n        // For time based animations, show divider lines for each 250ms progress.\n        const gridSize = isScrollDriven ? this.duration() / 10 : 250;\n        this.#grid.removeChildren();\n        let lastDraw = undefined;\n        for (let time = 0; time < this.duration(); time += gridSize) {\n            const line = UI.UIUtils.createSVGChild(this.#grid, 'rect', 'animation-timeline-grid-line');\n            line.setAttribute('x', (time * this.pixelTimeRatio() + 10).toString());\n            line.setAttribute('y', '23');\n            line.setAttribute('height', '100%');\n            line.setAttribute('width', '1');\n        }\n        for (let time = 0; time < this.duration(); time += gridSize) {\n            const gridWidth = time * this.pixelTimeRatio();\n            if (lastDraw === undefined || gridWidth - lastDraw > 50) {\n                lastDraw = gridWidth;\n                const label = UI.UIUtils.createSVGChild(this.#grid, 'text', 'animation-timeline-grid-label');\n                label.textContent = isScrollDriven ? `${time.toFixed(0)}px` : i18n.TimeUtilities.millisToString(time);\n                label.setAttribute('x', (gridWidth + 10).toString());\n                label.setAttribute('y', '16');\n            }\n        }\n    }\n    scheduleRedraw() {\n        this.renderGrid();\n        this.#renderQueue = [];\n        for (const ui of this.#uiAnimations) {\n            this.#renderQueue.push(ui);\n        }\n        if (this.#redrawing) {\n            return;\n        }\n        this.#redrawing = true;\n        this.#animationsContainer.window().requestAnimationFrame(this.render.bind(this));\n    }\n    render(timestamp) {\n        while (this.#renderQueue.length && (!timestamp || window.performance.now() - timestamp < 50)) {\n            const animationUI = this.#renderQueue.shift();\n            if (animationUI) {\n                animationUI.redraw();\n            }\n        }\n        if (this.#renderQueue.length) {\n            this.#animationsContainer.window().requestAnimationFrame(this.render.bind(this));\n        }\n        else {\n            this.#redrawing = undefined;\n        }\n    }\n    onResize() {\n        this.#cachedTimelineWidth = Math.max(0, this.#animationsContainer.offsetWidth - this.#timelineControlsWidth) || 0;\n        this.scheduleRedraw();\n        if (this.#scrubberPlayer) {\n            this.syncScrubber();\n        }\n        this.#gridOffsetLeft = undefined;\n    }\n    width() {\n        return this.#cachedTimelineWidth || 0;\n    }\n    syncScrubber() {\n        if (!this.#selectedGroup || !this.hasAnimationGroupActiveNodes()) {\n            return;\n        }\n        void this.#selectedGroup.currentTimePromise()\n            .then(this.animateTime.bind(this))\n            .then(this.updateControlButton.bind(this));\n    }\n    animateTime(currentTime) {\n        // Scroll driven animations are bound to the scroll position of the scroll container\n        // thus we don't animate the scrubber based on time for scroll driven animations.\n        if (this.#selectedGroup?.isScrollDriven()) {\n            return;\n        }\n        if (this.#scrubberPlayer) {\n            this.#scrubberPlayer.cancel();\n        }\n        this.#scrubberPlayer = this.#timelineScrubber.animate([{ transform: 'translateX(0px)' }, { transform: 'translateX(' + this.width() + 'px)' }], { duration: this.duration(), fill: 'forwards' });\n        this.#scrubberPlayer.playbackRate = this.effectivePlaybackRate();\n        this.#scrubberPlayer.onfinish = this.updateControlButton.bind(this);\n        this.#scrubberPlayer.currentTime = currentTime;\n        this.element.window().requestAnimationFrame(this.updateScrubber.bind(this));\n    }\n    pixelTimeRatio() {\n        return this.width() / this.duration() || 0;\n    }\n    updateScrubber(_timestamp) {\n        if (!this.#scrubberPlayer) {\n            return;\n        }\n        this.setCurrentTimeText(this.#scrubberCurrentTime());\n        if (this.#scrubberPlayer.playState.toString() === 'pending' || this.#scrubberPlayer.playState === 'running') {\n            this.element.window().requestAnimationFrame(this.updateScrubber.bind(this));\n        }\n        else if (this.#scrubberPlayer.playState === 'finished') {\n            this.clearCurrentTimeText();\n        }\n    }\n    scrubberDragStart(event) {\n        if (!this.#selectedGroup || !this.hasAnimationGroupActiveNodes()) {\n            return false;\n        }\n        // Seek to current mouse position.\n        if (!this.#gridOffsetLeft) {\n            this.#gridOffsetLeft = this.#grid.getBoundingClientRect().left + 10;\n        }\n        const { x } = event;\n        const seekTime = Math.max(0, x - this.#gridOffsetLeft) / this.pixelTimeRatio();\n        // Interface with scrubber drag.\n        this.#originalScrubberTime = seekTime;\n        this.#originalMousePosition = x;\n        this.setCurrentTimeText(seekTime);\n        if (this.#selectedGroup.isScrollDriven()) {\n            this.setTimelineScrubberPosition(seekTime);\n            void this.updateScrollOffsetOnPage(seekTime);\n        }\n        else {\n            const currentTime = this.#scrubberPlayer?.currentTime;\n            this.#animationGroupPausedBeforeScrub =\n                this.#selectedGroup.paused() || typeof currentTime === 'number' && currentTime >= this.duration();\n            this.#selectedGroup.seekTo(seekTime);\n            this.togglePause(true);\n            this.animateTime(seekTime);\n        }\n        return true;\n    }\n    async updateScrollOffsetOnPage(offset) {\n        const node = await this.#selectedGroup?.scrollNode();\n        if (!node) {\n            return;\n        }\n        if (this.#selectedGroup?.scrollOrientation() === \"vertical\" /* Protocol.DOM.ScrollOrientation.Vertical */) {\n            return node.setScrollTop(offset);\n        }\n        return node.setScrollLeft(offset);\n    }\n    setTimelineScrubberPosition(time) {\n        this.#timelineScrubber.style.transform = `translateX(${time * this.pixelTimeRatio()}px)`;\n    }\n    scrubberDragMove(event) {\n        const { x } = event;\n        const delta = x - (this.#originalMousePosition || 0);\n        const currentTime = Math.max(0, Math.min((this.#originalScrubberTime || 0) + delta / this.pixelTimeRatio(), this.duration()));\n        if (this.#scrubberPlayer) {\n            this.#scrubberPlayer.currentTime = currentTime;\n        }\n        else {\n            this.setTimelineScrubberPosition(currentTime);\n            void this.updateScrollOffsetOnPage(currentTime);\n        }\n        this.setCurrentTimeText(currentTime);\n        if (this.#selectedGroup && !this.#selectedGroup.isScrollDriven()) {\n            this.#selectedGroup.seekTo(currentTime);\n        }\n    }\n    #scrubberCurrentTime() {\n        return typeof this.#scrubberPlayer?.currentTime === 'number' ? this.#scrubberPlayer.currentTime : 0;\n    }\n    scrubberDragEnd(_event) {\n        if (this.#scrubberPlayer) {\n            const currentTime = Math.max(0, this.#scrubberCurrentTime());\n            this.#scrubberPlayer.play();\n            this.#scrubberPlayer.currentTime = currentTime;\n        }\n        Host.userMetrics.actionTaken(Host.UserMetrics.Action.AnimationGroupScrubbed);\n        if (this.#selectedGroup?.isScrollDriven()) {\n            Host.userMetrics.actionTaken(Host.UserMetrics.Action.ScrollDrivenAnimationGroupScrubbed);\n        }\n        this.#currentTime.window().requestAnimationFrame(this.updateScrubber.bind(this));\n        if (!this.#animationGroupPausedBeforeScrub) {\n            this.togglePause(false);\n        }\n    }\n}\nexport const GlobalPlaybackRates = [1, 0.25, 0.1];\nexport class NodeUI {\n    element;\n    #description;\n    #timelineElement;\n    #overlayElement;\n    #node;\n    constructor(_animationEffect) {\n        this.element = document.createElement('div');\n        this.element.classList.add('animation-node-row');\n        this.#description = this.element.createChild('div', 'animation-node-description');\n        this.#description.setAttribute('jslog', `${VisualLogging.tableCell('description').track({ resize: true })}`);\n        this.#timelineElement = this.element.createChild('div', 'animation-node-timeline');\n        this.#timelineElement.setAttribute('jslog', `${VisualLogging.tableCell('timeline').track({ resize: true })}`);\n        UI.ARIAUtils.markAsApplication(this.#timelineElement);\n    }\n    nodeResolved(node) {\n        if (!node) {\n            UI.UIUtils.createTextChild(this.#description, '<node>');\n            return;\n        }\n        this.#node = node;\n        this.nodeChanged();\n        void Common.Linkifier.Linkifier.linkify(node).then(link => {\n            link.addEventListener('click', () => {\n                Host.userMetrics.actionTaken(Host.UserMetrics.Action.AnimatedNodeDescriptionClicked);\n            });\n            this.#description.appendChild(link);\n        });\n        if (!node.ownerDocument) {\n            this.nodeRemoved();\n        }\n    }\n    createNewRow() {\n        return this.#timelineElement.createChild('div', 'animation-timeline-row');\n    }\n    nodeRemoved() {\n        this.element.classList.add('animation-node-removed');\n        if (!this.#overlayElement) {\n            this.#overlayElement = document.createElement('div');\n            this.#overlayElement.classList.add('animation-node-removed-overlay');\n            this.#description.appendChild(this.#overlayElement);\n        }\n        this.#node = null;\n    }\n    hasActiveNode() {\n        return Boolean(this.#node);\n    }\n    nodeChanged() {\n        let animationNodeSelected = false;\n        if (this.#node) {\n            animationNodeSelected = (this.#node === UI.Context.Context.instance().flavor(SDK.DOMModel.DOMNode));\n        }\n        this.element.classList.toggle('animation-node-selected', animationNodeSelected);\n    }\n}\nexport class StepTimingFunction {\n    steps;\n    stepAtPosition;\n    constructor(steps, stepAtPosition) {\n        this.steps = steps;\n        this.stepAtPosition = stepAtPosition;\n    }\n    static parse(text) {\n        let match = text.match(/^steps\\((\\d+), (start|middle)\\)$/);\n        if (match) {\n            return new StepTimingFunction(parseInt(match[1], 10), match[2]);\n        }\n        match = text.match(/^steps\\((\\d+)\\)$/);\n        if (match) {\n            return new StepTimingFunction(parseInt(match[1], 10), 'end');\n        }\n        return null;\n    }\n}\n//# sourceMappingURL=AnimationTimeline.js.map","// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as InlineEditor from '../../ui/legacy/components/inline_editor/inline_editor.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\nimport { StepTimingFunction } from './AnimationTimeline.js';\nconst UIStrings = {\n    /**\n     *@description Title of the first and last points of an animation\n     */\n    animationEndpointSlider: 'Animation Endpoint slider',\n    /**\n     *@description Title of an Animation Keyframe point\n     */\n    animationKeyframeSlider: 'Animation Keyframe slider',\n    /**\n     *@description Title of an animation keyframe group\n     *@example {anilogo} PH1\n     */\n    sSlider: '{PH1} slider',\n};\nconst str_ = i18n.i18n.registerUIStrings('panels/animation/AnimationUI.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class AnimationUI {\n    #animationInternal;\n    #timeline;\n    #keyframes;\n    #nameElement;\n    #svg;\n    #activeIntervalGroup;\n    #cachedElements;\n    #movementInMs;\n    #keyboardMovementRateMs;\n    #color;\n    #node;\n    #delayLine;\n    #endDelayLine;\n    #tailGroup;\n    #mouseEventType;\n    #keyframeMoved;\n    #downMouseX;\n    constructor(animation, timeline, parentElement) {\n        this.#animationInternal = animation;\n        this.#timeline = timeline;\n        const keyframesRule = this.#animationInternal.source().keyframesRule();\n        if (keyframesRule) {\n            this.#keyframes = keyframesRule.keyframes();\n            if (animation.viewOrScrollTimeline() && animation.playbackRate() < 0) {\n                this.#keyframes.reverse();\n            }\n        }\n        this.#nameElement = parentElement.createChild('div', 'animation-name');\n        this.#nameElement.textContent = this.#animationInternal.name();\n        this.#svg = UI.UIUtils.createSVGChild(parentElement, 'svg', 'animation-ui');\n        this.#svg.setAttribute('height', Options.AnimationSVGHeight.toString());\n        this.#svg.style.marginLeft = '-' + Options.AnimationMargin + 'px';\n        this.#svg.addEventListener('contextmenu', this.onContextMenu.bind(this));\n        this.#activeIntervalGroup = UI.UIUtils.createSVGChild(this.#svg, 'g');\n        this.#activeIntervalGroup.setAttribute('jslog', `${VisualLogging.animationClip().track({ drag: true })}`);\n        if (!this.#animationInternal.viewOrScrollTimeline()) {\n            UI.UIUtils.installDragHandle(this.#activeIntervalGroup, this.mouseDown.bind(this, \"AnimationDrag\" /* Events.ANIMATION_DRAG */, null), this.mouseMove.bind(this), this.mouseUp.bind(this), '-webkit-grabbing', '-webkit-grab');\n            AnimationUI.installDragHandleKeyboard(this.#activeIntervalGroup, this.keydownMove.bind(this, \"AnimationDrag\" /* Events.ANIMATION_DRAG */, null));\n        }\n        this.#cachedElements = [];\n        this.#movementInMs = 0;\n        this.#keyboardMovementRateMs = 50;\n        this.#color = AnimationUI.colorForAnimation(this.#animationInternal);\n    }\n    static colorForAnimation(animation) {\n        const names = Array.from(Colors.keys());\n        const hashCode = Platform.StringUtilities.hashCode(animation.name() || animation.id());\n        const cappedHashCode = hashCode % names.length;\n        const colorName = names[cappedHashCode];\n        const color = Colors.get(colorName);\n        if (!color) {\n            throw new Error('Unable to locate color');\n        }\n        return color.asString(\"rgb\" /* Common.Color.Format.RGB */) || '';\n    }\n    static installDragHandleKeyboard(element, elementDrag) {\n        element.addEventListener('keydown', elementDrag, false);\n    }\n    animation() {\n        return this.#animationInternal;\n    }\n    get nameElement() {\n        return this.#nameElement;\n    }\n    get svg() {\n        return this.#svg;\n    }\n    setNode(node) {\n        this.#node = node;\n    }\n    createLine(parentElement, className) {\n        const line = UI.UIUtils.createSVGChild(parentElement, 'line', className);\n        line.setAttribute('x1', Options.AnimationMargin.toString());\n        line.setAttribute('y1', Options.AnimationHeight.toString());\n        line.setAttribute('y2', Options.AnimationHeight.toString());\n        line.style.stroke = this.#color;\n        return line;\n    }\n    drawAnimationLine(iteration, parentElement) {\n        const cache = this.#cachedElements[iteration];\n        if (!cache.animationLine) {\n            cache.animationLine = this.createLine(parentElement, 'animation-line');\n        }\n        if (!cache.animationLine) {\n            return;\n        }\n        cache.animationLine.setAttribute('x2', (this.duration() * this.#timeline.pixelTimeRatio() + Options.AnimationMargin).toFixed(2));\n    }\n    drawDelayLine(parentElement) {\n        if (!this.#delayLine || !this.#endDelayLine) {\n            this.#delayLine = this.createLine(parentElement, 'animation-delay-line');\n            this.#endDelayLine = this.createLine(parentElement, 'animation-delay-line');\n        }\n        const fill = this.#animationInternal.source().fill();\n        this.#delayLine.classList.toggle('animation-fill', fill === 'backwards' || fill === 'both');\n        const margin = Options.AnimationMargin;\n        this.#delayLine.setAttribute('x1', margin.toString());\n        this.#delayLine.setAttribute('x2', (this.delayOrStartTime() * this.#timeline.pixelTimeRatio() + margin).toFixed(2));\n        const forwardsFill = fill === 'forwards' || fill === 'both';\n        this.#endDelayLine.classList.toggle('animation-fill', forwardsFill);\n        const leftMargin = Math.min(this.#timeline.width(), (this.delayOrStartTime() + this.duration() * this.#animationInternal.source().iterations()) *\n            this.#timeline.pixelTimeRatio());\n        this.#endDelayLine.style.transform = 'translateX(' + leftMargin.toFixed(2) + 'px)';\n        this.#endDelayLine.setAttribute('x1', margin.toString());\n        this.#endDelayLine.setAttribute('x2', forwardsFill ?\n            (this.#timeline.width() - leftMargin + margin).toFixed(2) :\n            (this.#animationInternal.source().endDelay() * this.#timeline.pixelTimeRatio() + margin).toFixed(2));\n    }\n    drawPoint(iteration, parentElement, x, keyframeIndex, attachEvents) {\n        if (this.#cachedElements[iteration].keyframePoints[keyframeIndex]) {\n            this.#cachedElements[iteration].keyframePoints[keyframeIndex].setAttribute('cx', x.toFixed(2));\n            return;\n        }\n        const circle = UI.UIUtils.createSVGChild(parentElement, 'circle', keyframeIndex <= 0 ? 'animation-endpoint' : 'animation-keyframe-point');\n        circle.setAttribute('cx', x.toFixed(2));\n        circle.setAttribute('cy', Options.AnimationHeight.toString());\n        circle.style.stroke = this.#color;\n        circle.setAttribute('r', (Options.AnimationMargin / 2).toString());\n        circle.setAttribute('jslog', `${VisualLogging.controlPoint('animations.keyframe').track({ drag: true })}`);\n        circle.tabIndex = 0;\n        UI.ARIAUtils.setLabel(circle, keyframeIndex <= 0 ? i18nString(UIStrings.animationEndpointSlider) :\n            i18nString(UIStrings.animationKeyframeSlider));\n        if (keyframeIndex <= 0) {\n            circle.style.fill = this.#color;\n        }\n        this.#cachedElements[iteration].keyframePoints[keyframeIndex] = circle;\n        if (!attachEvents) {\n            return;\n        }\n        let eventType;\n        if (keyframeIndex === 0) {\n            eventType = \"StartEndpointMove\" /* Events.START_ENDPOINT_MOVE */;\n        }\n        else if (keyframeIndex === -1) {\n            eventType = \"FinishEndpointMove\" /* Events.FINISH_ENDPOINT_MOVE */;\n        }\n        else {\n            eventType = \"KeyframeMove\" /* Events.KEYFRAME_MOVE */;\n        }\n        if (!this.animation().viewOrScrollTimeline()) {\n            UI.UIUtils.installDragHandle(circle, this.mouseDown.bind(this, eventType, keyframeIndex), this.mouseMove.bind(this), this.mouseUp.bind(this), 'ew-resize');\n            AnimationUI.installDragHandleKeyboard(circle, this.keydownMove.bind(this, eventType, keyframeIndex));\n        }\n    }\n    renderKeyframe(iteration, keyframeIndex, parentElement, leftDistance, width, easing) {\n        function createStepLine(parentElement, x, strokeColor) {\n            const line = UI.UIUtils.createSVGChild(parentElement, 'line');\n            line.setAttribute('x1', x.toString());\n            line.setAttribute('x2', x.toString());\n            line.setAttribute('y1', Options.AnimationMargin.toString());\n            line.setAttribute('y2', Options.AnimationHeight.toString());\n            line.style.stroke = strokeColor;\n        }\n        const bezier = UI.Geometry.CubicBezier.parse(easing);\n        const cache = this.#cachedElements[iteration].keyframeRender;\n        if (!cache[keyframeIndex]) {\n            const svg = bezier ? UI.UIUtils.createSVGChild(parentElement, 'path', 'animation-keyframe') :\n                UI.UIUtils.createSVGChild(parentElement, 'g', 'animation-keyframe-step');\n            cache[keyframeIndex] = svg;\n        }\n        const group = cache[keyframeIndex];\n        group.tabIndex = 0;\n        UI.ARIAUtils.setLabel(group, i18nString(UIStrings.sSlider, { PH1: this.#animationInternal.name() }));\n        group.style.transform = 'translateX(' + leftDistance.toFixed(2) + 'px)';\n        if (easing === 'linear') {\n            group.style.fill = this.#color;\n            const height = InlineEditor.BezierUI.Height;\n            group.setAttribute('d', ['M', 0, height, 'L', 0, 5, 'L', width.toFixed(2), 5, 'L', width.toFixed(2), height, 'Z'].join(' '));\n        }\n        else if (bezier) {\n            group.style.fill = this.#color;\n            InlineEditor.BezierUI.BezierUI.drawVelocityChart(bezier, group, width);\n        }\n        else {\n            const stepFunction = StepTimingFunction.parse(easing);\n            group.removeChildren();\n            const offsetMap = { start: 0, middle: 0.5, end: 1 };\n            if (stepFunction) {\n                const offsetWeight = offsetMap[stepFunction.stepAtPosition];\n                for (let i = 0; i < stepFunction.steps; i++) {\n                    createStepLine(group, (i + offsetWeight) * width / stepFunction.steps, this.#color);\n                }\n            }\n        }\n    }\n    redraw() {\n        const maxWidth = this.#timeline.width() - Options.AnimationMargin;\n        this.#svg.setAttribute('width', (maxWidth + 2 * Options.AnimationMargin).toFixed(2));\n        this.#activeIntervalGroup.style.transform =\n            'translateX(' + (this.delayOrStartTime() * this.#timeline.pixelTimeRatio()).toFixed(2) + 'px)';\n        this.#nameElement.style.transform = 'translateX(' +\n            (Math.max(this.delayOrStartTime(), 0) * this.#timeline.pixelTimeRatio() + Options.AnimationMargin).toFixed(2) +\n            'px)';\n        this.#nameElement.style.width = (this.duration() * this.#timeline.pixelTimeRatio()).toFixed(2) + 'px';\n        this.drawDelayLine(this.#svg);\n        if (this.#animationInternal.type() === 'CSSTransition') {\n            this.renderTransition();\n            return;\n        }\n        this.renderIteration(this.#activeIntervalGroup, 0);\n        if (!this.#tailGroup) {\n            this.#tailGroup = UI.UIUtils.createSVGChild(this.#activeIntervalGroup, 'g', 'animation-tail-iterations');\n        }\n        const iterationWidth = this.duration() * this.#timeline.pixelTimeRatio();\n        let iteration;\n        // Some iterations are getting rendered in an invisible area if the delay is negative.\n        const invisibleAreaWidth = this.delayOrStartTime() < 0 ? -this.delayOrStartTime() * this.#timeline.pixelTimeRatio() : 0;\n        for (iteration = 1; iteration < this.#animationInternal.source().iterations() &&\n            iterationWidth * (iteration - 1) < invisibleAreaWidth + this.#timeline.width() &&\n            (iterationWidth > 0 || this.#animationInternal.source().iterations() !== Infinity); iteration++) {\n            this.renderIteration(this.#tailGroup, iteration);\n        }\n        while (iteration < this.#cachedElements.length) {\n            const poppedElement = this.#cachedElements.pop();\n            if (poppedElement && poppedElement.group) {\n                poppedElement.group.remove();\n            }\n        }\n    }\n    renderTransition() {\n        const activeIntervalGroup = this.#activeIntervalGroup;\n        if (!this.#cachedElements[0]) {\n            this.#cachedElements[0] = { animationLine: null, keyframePoints: {}, keyframeRender: {}, group: null };\n        }\n        this.drawAnimationLine(0, activeIntervalGroup);\n        this.renderKeyframe(0, 0, activeIntervalGroup, Options.AnimationMargin, this.duration() * this.#timeline.pixelTimeRatio(), this.#animationInternal.source().easing());\n        this.drawPoint(0, activeIntervalGroup, Options.AnimationMargin, 0, true);\n        this.drawPoint(0, activeIntervalGroup, this.duration() * this.#timeline.pixelTimeRatio() + Options.AnimationMargin, -1, true);\n    }\n    renderIteration(parentElement, iteration) {\n        if (!this.#cachedElements[iteration]) {\n            this.#cachedElements[iteration] = {\n                animationLine: null,\n                keyframePoints: {},\n                keyframeRender: {},\n                group: UI.UIUtils.createSVGChild(parentElement, 'g'),\n            };\n        }\n        const group = this.#cachedElements[iteration].group;\n        if (!group) {\n            return;\n        }\n        group.style.transform =\n            'translateX(' + (iteration * this.duration() * this.#timeline.pixelTimeRatio()).toFixed(2) + 'px)';\n        this.drawAnimationLine(iteration, group);\n        if (this.#keyframes && this.#keyframes.length > 1) {\n            for (let i = 0; i < this.#keyframes.length - 1; i++) {\n                const leftDistance = this.offset(i) * this.duration() * this.#timeline.pixelTimeRatio() + Options.AnimationMargin;\n                const width = this.duration() * (this.offset(i + 1) - this.offset(i)) * this.#timeline.pixelTimeRatio();\n                this.renderKeyframe(iteration, i, group, leftDistance, width, this.#keyframes[i].easing());\n                if (i || (!i && iteration === 0)) {\n                    this.drawPoint(iteration, group, leftDistance, i, iteration === 0);\n                }\n            }\n        }\n        this.drawPoint(iteration, group, this.duration() * this.#timeline.pixelTimeRatio() + Options.AnimationMargin, -1, iteration === 0);\n    }\n    delayOrStartTime() {\n        let delay = this.#animationInternal.delayOrStartTime();\n        if (this.#mouseEventType === \"AnimationDrag\" /* Events.ANIMATION_DRAG */ || this.#mouseEventType === \"StartEndpointMove\" /* Events.START_ENDPOINT_MOVE */) {\n            delay += this.#movementInMs;\n        }\n        return delay;\n    }\n    duration() {\n        let duration = this.#animationInternal.iterationDuration();\n        if (this.#mouseEventType === \"FinishEndpointMove\" /* Events.FINISH_ENDPOINT_MOVE */) {\n            duration += this.#movementInMs;\n        }\n        else if (this.#mouseEventType === \"StartEndpointMove\" /* Events.START_ENDPOINT_MOVE */) {\n            duration -= this.#movementInMs;\n        }\n        return Math.max(0, duration);\n    }\n    offset(i) {\n        if (!this.#keyframes) {\n            throw new Error('Unable to calculate offset; keyframes do not exist');\n        }\n        let offset = this.#keyframes[i].offsetAsNumber();\n        if (this.#mouseEventType === \"KeyframeMove\" /* Events.KEYFRAME_MOVE */ && i === this.#keyframeMoved) {\n            console.assert(i > 0 && i < this.#keyframes.length - 1, 'First and last keyframe cannot be moved');\n            offset += this.#movementInMs / this.#animationInternal.iterationDuration();\n            offset = Math.max(offset, this.#keyframes[i - 1].offsetAsNumber());\n            offset = Math.min(offset, this.#keyframes[i + 1].offsetAsNumber());\n        }\n        return offset;\n    }\n    mouseDown(mouseEventType, keyframeIndex, event) {\n        const mouseEvent = event;\n        if (mouseEvent.buttons === 2) {\n            return false;\n        }\n        if (this.#svg.enclosingNodeOrSelfWithClass('animation-node-removed')) {\n            return false;\n        }\n        this.#mouseEventType = mouseEventType;\n        this.#keyframeMoved = keyframeIndex;\n        this.#downMouseX = mouseEvent.clientX;\n        event.consume(true);\n        const viewManagerInstance = UI.ViewManager.ViewManager.instance();\n        const animationLocation = viewManagerInstance.locationNameForViewId('animations');\n        const elementsLocation = viewManagerInstance.locationNameForViewId('elements');\n        // Prevents revealing the node if the animations and elements view share the same view location.\n        // If they share the same view location, the animations view will change to the elements view when editing an animation\n        if (this.#node && animationLocation !== elementsLocation) {\n            void Common.Revealer.reveal(this.#node);\n        }\n        return true;\n    }\n    mouseMove(event) {\n        const mouseEvent = event;\n        this.setMovementAndRedraw((mouseEvent.clientX - (this.#downMouseX || 0)) / this.#timeline.pixelTimeRatio());\n    }\n    setMovementAndRedraw(movement) {\n        this.#movementInMs = movement;\n        if (this.delayOrStartTime() + this.duration() > this.#timeline.duration() * 0.8) {\n            this.#timeline.setDuration(this.#timeline.duration() * 1.2);\n        }\n        this.redraw();\n    }\n    mouseUp(event) {\n        const mouseEvent = event;\n        this.#movementInMs = (mouseEvent.clientX - (this.#downMouseX || 0)) / this.#timeline.pixelTimeRatio();\n        // Commit changes\n        if (this.#mouseEventType === \"KeyframeMove\" /* Events.KEYFRAME_MOVE */) {\n            if (this.#keyframes && this.#keyframeMoved !== null && typeof this.#keyframeMoved !== 'undefined') {\n                this.#keyframes[this.#keyframeMoved].setOffset(this.offset(this.#keyframeMoved));\n            }\n        }\n        else {\n            this.#animationInternal.setTiming(this.duration(), this.delayOrStartTime());\n        }\n        Host.userMetrics.animationPointDragged(this.#mouseEventType === \"AnimationDrag\" /* Events.ANIMATION_DRAG */ ? 0 /* Host.UserMetrics.AnimationPointDragType.ANIMATION_DRAG */ :\n            this.#mouseEventType === \"KeyframeMove\" /* Events.KEYFRAME_MOVE */ ?\n                1 /* Host.UserMetrics.AnimationPointDragType.KEYFRAME_MOVE */ :\n                this.#mouseEventType === \"StartEndpointMove\" /* Events.START_ENDPOINT_MOVE */ ?\n                    2 /* Host.UserMetrics.AnimationPointDragType.START_ENDPOINT_MOVE */ :\n                    this.#mouseEventType === \"FinishEndpointMove\" /* Events.FINISH_ENDPOINT_MOVE */ ?\n                        3 /* Host.UserMetrics.AnimationPointDragType.FINISH_ENDPOINT_MOVE */ :\n                        4 /* Host.UserMetrics.AnimationPointDragType.OTHER */);\n        this.#movementInMs = 0;\n        this.redraw();\n        this.#mouseEventType = undefined;\n        this.#downMouseX = undefined;\n        this.#keyframeMoved = undefined;\n    }\n    keydownMove(mouseEventType, keyframeIndex, event) {\n        const keyboardEvent = event;\n        this.#mouseEventType = mouseEventType;\n        this.#keyframeMoved = keyframeIndex;\n        switch (keyboardEvent.key) {\n            case 'ArrowLeft':\n            case 'ArrowUp':\n                this.#movementInMs = -this.#keyboardMovementRateMs;\n                break;\n            case 'ArrowRight':\n            case 'ArrowDown':\n                this.#movementInMs = this.#keyboardMovementRateMs;\n                break;\n            default:\n                return;\n        }\n        if (this.#mouseEventType === \"KeyframeMove\" /* Events.KEYFRAME_MOVE */) {\n            if (this.#keyframes && this.#keyframeMoved !== null) {\n                this.#keyframes[this.#keyframeMoved].setOffset(this.offset(this.#keyframeMoved));\n            }\n        }\n        else {\n            this.#animationInternal.setTiming(this.duration(), this.delayOrStartTime());\n        }\n        this.setMovementAndRedraw(0);\n        this.#mouseEventType = undefined;\n        this.#keyframeMoved = undefined;\n        event.consume(true);\n    }\n    onContextMenu(event) {\n        function showContextMenu(remoteObject) {\n            if (!remoteObject) {\n                return;\n            }\n            const contextMenu = new UI.ContextMenu.ContextMenu(event);\n            contextMenu.appendApplicableItems(remoteObject);\n            void contextMenu.show();\n        }\n        void this.#animationInternal.remoteObjectPromise().then(showContextMenu);\n        event.consume(true);\n    }\n}\nexport const Options = {\n    AnimationHeight: 26,\n    AnimationSVGHeight: 50,\n    AnimationMargin: 7,\n    EndpointsClickRegionSize: 10,\n    GridCanvasHeight: 40,\n};\nexport const Colors = new Map([\n    ['Purple', Common.Color.parse('#9C27B0')],\n    ['Light Blue', Common.Color.parse('#03A9F4')],\n    ['Deep Orange', Common.Color.parse('#FF5722')],\n    ['Blue', Common.Color.parse('#5677FC')],\n    ['Lime', Common.Color.parse('#CDDC39')],\n    ['Blue Grey', Common.Color.parse('#607D8B')],\n    ['Pink', Common.Color.parse('#E91E63')],\n    ['Green', Common.Color.parse('#0F9D58')],\n    ['Brown', Common.Color.parse('#795548')],\n    ['Cyan', Common.Color.parse('#00BCD4')],\n]);\n//# sourceMappingURL=AnimationUI.js.map","// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as IconButton from '../../ui/components/icon_button/icon_button.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\nimport { AnimationUI } from './AnimationUI.js';\nexport class AnimationGroupPreviewUI {\n    #model;\n    element;\n    #removeButtonInternal;\n    #replayOverlayElement;\n    #svg;\n    #viewBoxHeight;\n    constructor(model) {\n        this.#model = model;\n        this.element = document.createElement('button');\n        this.element.setAttribute('jslog', `${VisualLogging.item(`animations.buffer-preview${model.isScrollDriven() ? '-sda' : ''}`).track({\n            click: true,\n        })}`);\n        this.element.classList.add('animation-buffer-preview');\n        this.element.addEventListener('animationend', () => {\n            this.element.classList.add('no-animation');\n        });\n        this.element.createChild('div', 'animation-paused fill');\n        if (model.isScrollDriven()) {\n            this.element.appendChild(IconButton.Icon.create('mouse', 'preview-icon'));\n        }\n        else {\n            this.element.appendChild(IconButton.Icon.create('watch', 'preview-icon'));\n        }\n        this.#removeButtonInternal = this.element.createChild('button', 'animation-remove-button');\n        this.#removeButtonInternal.setAttribute('jslog', `${VisualLogging.action('animations.remove-preview').track({ click: true })}`);\n        this.#removeButtonInternal.appendChild(IconButton.Icon.create('cross'));\n        this.#replayOverlayElement = this.element.createChild('div', 'animation-buffer-preview-animation');\n        this.#svg = UI.UIUtils.createSVGChild(this.element, 'svg');\n        this.#svg.setAttribute('width', '100%');\n        this.#svg.setAttribute('preserveAspectRatio', 'none');\n        this.#svg.setAttribute('height', '100%');\n        this.#viewBoxHeight = 32;\n        this.#svg.setAttribute('viewBox', '0 0 100 ' + this.#viewBoxHeight);\n        this.#svg.setAttribute('shape-rendering', 'crispEdges');\n        this.render();\n    }\n    removeButton() {\n        return this.#removeButtonInternal;\n    }\n    replay() {\n        this.#replayOverlayElement.animate([\n            { offset: 0, width: '0%', opacity: 1 },\n            { offset: 0.9, width: '100%', opacity: 1 },\n            { offset: 1, width: '100%', opacity: 0 },\n        ], { duration: 200, easing: 'cubic-bezier(0, 0, 0.2, 1)' });\n    }\n    render() {\n        this.#svg.removeChildren();\n        const maxToShow = 10;\n        const numberOfAnimations = Math.min(this.#model.animations().length, maxToShow);\n        const timeToPixelRatio = 100 / Math.max(this.#model.groupDuration(), 750);\n        for (let i = 0; i < numberOfAnimations; i++) {\n            const animation = this.#model.animations()[i];\n            const line = UI.UIUtils.createSVGChild(this.#svg, 'line');\n            const startPoint = animation.delayOrStartTime();\n            const endPoint = startPoint + animation.iterationDuration();\n            line.setAttribute('x1', String(startPoint * timeToPixelRatio));\n            line.setAttribute('x2', String(endPoint * timeToPixelRatio));\n            const y = String(Math.floor(this.#viewBoxHeight / Math.max(6, numberOfAnimations) * i + 1));\n            line.setAttribute('y1', y);\n            line.setAttribute('y2', y);\n            line.style.stroke = AnimationUI.colorForAnimation(this.#model.animations()[i]);\n        }\n    }\n}\n//# sourceMappingURL=AnimationGroupPreviewUI.js.map"],"names":["DEVTOOLS_ANIMATIONS_WORLD_NAME","REPORT_SCROLL_POSITION_BINDING_NAME","getScrollListenerNameInPage","id","resolveToObjectInWorld","domNode","worldName","resourceTreeModel","SDK.ResourceTreeModel.ResourceTreeModel","pageAgent","frame","executionContextId","object","AnimationDOMNode","#domNode","#scrollListenersById","#scrollBindingListener","#addReportScrollPositionBinding","ev","name","payload","scrollTop","scrollLeft","scrollListener","runtimeModel","SDK.RuntimeModel.RuntimeModel","SDK.RuntimeModel.Events","#removeReportScrollPositionBinding","onScroll","scrollListenerInPage","arg","SDK.RemoteObject.RemoteObject","reportScrollPositionBindingName","scrollListenerNameInPage","scrollingElement","removeScrollListenerInPage","scrollTopInPage","res","scrollLeftInPage","offset","setScrollTopInPage","offsetInPage","setScrollLeftInPage","verticalScrollRangeInPage","horizontalScrollRangeInPage","shouldGroupAnimations","firstAnimation","anim","firstAnimationTimeline","animationTimeline","AnimationModel","SDK.SDKModel.SDKModel","#animationsById","#pendingAnimations","#screenshotCapture","#enabled","#flushPendingAnimations","target","AnimationDispatcher","SDK.ResourceTreeModel.Events","screenCaptureModel","SDK.ScreenCaptureModel.ScreenCaptureModel","ScreenshotCapture","Common.Debouncer.debounce","Events","evaluateResult","foundAnimationGroup","foundAnimation","animationGroup","animation","AnimationImpl","keyframesRule","incomingGroup","matchedGroup","group","firstAnimationId","groupedAnimations","remainingAnimations","anim1","anim2","AnimationGroup","playbackRate","animations","#animationModel","#payloadInternal","#sourceInternal","#playStateInternal","animationModel","devicePixelRatio","AnimationEffect","percentage","viewOrScrollTimeline","startOffset","endOffset","playState","iterations","secondAnimation","duration","delay","node","animationPrefix","cssModel","#payload","#keyframesRuleInternal","#deferredNodeInternal","KeyframesRule","SDK.DOMModel.DeferredDOMNode","#keyframesInternal","keyframeStyle","index","KeyframeStyle","#offsetInternal","#idInternal","#scrollNodeInternal","#animationsInternal","#pausedInternal","#screenshotImages","extractId","maxDuration","i","timeline","sourceNodeId","scrollNode","currentTime","paused","longestAnim","timelineId","left","right","firstIncomingAnimation","image","_event","#requests","#screenCaptureModel","#stopTimer","#endTime","#capturing","screenshots","screencastDuration","endTime","_visible","base64Data","_metadata","isAnimating","request","now","styles","AnimationScreenshotPopover","UI.Widget.VBox","#frames","#rafId","#currentFrame","#progressBar","#showFrame","#endDelay","images","animationScreenshotPopoverStyles","numFrames","UIStrings","str_","i18n.i18n.registerUIStrings","i18nString","i18n.i18n.getLocalizedString","nodeUIsByNode","playbackRates","MIN_TIMELINE_CONTROLS_WIDTH","DEFAULT_TIMELINE_CONTROLS_WIDTH","MAX_TIMELINE_CONTROLS_WIDTH","animationTimelineInstance","AnimationTimeline","#gridWrapper","#grid","#playbackRate","#allPaused","#screenshotPopovers","#animationsContainer","#playbackRateButtons","#previewContainer","#timelineScrubber","#currentTime","#clearButton","#selectedGroup","#renderQueue","#defaultDuration","#durationInternal","#timelineControlsWidth","#nodesMap","#uiAnimations","#groupBuffer","#previewMap","#animationsMap","#timelineScrubberLine","#pauseButton","#controlButton","#controlState","#redrawing","#cachedTimelineWidth","#scrubberPlayer","#gridOffsetLeft","#originalScrubberTime","#animationGroupPausedBeforeScrub","#originalMousePosition","#timelineControlsResizer","#gridHeader","#scrollListenerId","#collectedGroups","#createPreviewForCollectedGroupsThrottler","Common.Throttler.Throttler","#animationGroupUpdatedThrottler","#initialized","VisualLogging.panel","UI.UIUtils.createSVGChild","VisualLogging.section","timelineHint","SDK.TargetManager.TargetManager","SDK.DOMModel.DOMModel","SDK.DOMModel.Events","UI.Context.Context","SDK.DOMModel.DOMNode","#setupTimelineControlsResizer","opts","resizeOriginX","UI.UIUtils.installDragHandle","newWidth","animationTimelineStyles","nodeUI","toolbarContainer","VisualLogging.toolbar","topToolbar","UI.Toolbar.Toolbar","UI.Toolbar.ToolbarButton","Host.userMetrics","Host.UserMetrics.Action","UI.Toolbar.ToolbarToggle","playbackRateControl","UI.ARIAUtils.markAsListBox","UI.ARIAUtils.setLabel","GlobalPlaybackRates","button","VisualLogging.action","UI.ARIAUtils.markAsOption","UI.Tooltip.Tooltip","emptyBufferHint","container","controls","toolbar","VisualLogging.timeline","event","focusPrevious","currentIndex","nextIndex","nextButton","selected","pause","preview","data","animationNode","scrollRange","scrollOffset","popover","AnimationGroupPreviewUI","previewUiContainer","screenshotsContainer","width","createAndShowScreenshotPopover","screenshotPopover","a","b","previewGroup","groupsToDiscard","bufferSize","toDiscard","g","discardGroup","currentGroupIndex","Platform.ArrayUtilities.removeElement","nextGroup","time","i18n.TimeUtilities.millisToString","previewUI","NodeUI","nodeRow","uiAnimation","AnimationUI","pseudoElements","pseudoElement","child","isScrollDriven","gridSize","lastDraw","line","gridWidth","label","ui","timestamp","animationUI","_timestamp","#scrubberCurrentTime","x","seekTime","delta","#description","#timelineElement","#overlayElement","#node","_animationEffect","VisualLogging.tableCell","UI.ARIAUtils.markAsApplication","UI.UIUtils.createTextChild","Common.Linkifier.Linkifier","link","animationNodeSelected","StepTimingFunction","steps","stepAtPosition","text","match","#animationInternal","#timeline","#keyframes","#nameElement","#svg","#activeIntervalGroup","#cachedElements","#movementInMs","#keyboardMovementRateMs","#color","#delayLine","#endDelayLine","#tailGroup","#mouseEventType","#keyframeMoved","#downMouseX","parentElement","Options","VisualLogging.animationClip","names","Colors","cappedHashCode","Platform.StringUtilities.hashCode","colorName","color","element","elementDrag","className","iteration","cache","fill","margin","forwardsFill","leftMargin","keyframeIndex","attachEvents","circle","VisualLogging.controlPoint","eventType","leftDistance","easing","createStepLine","strokeColor","bezier","UI.Geometry.CubicBezier","svg","height","InlineEditor.BezierUI.Height","InlineEditor.BezierUI.BezierUI","stepFunction","offsetMap","offsetWeight","maxWidth","iterationWidth","invisibleAreaWidth","poppedElement","activeIntervalGroup","mouseEventType","mouseEvent","viewManagerInstance","UI.ViewManager.ViewManager","animationLocation","elementsLocation","Common.Revealer.reveal","movement","keyboardEvent","showContextMenu","remoteObject","contextMenu","UI.ContextMenu.ContextMenu","Common.Color.parse","#model","#removeButtonInternal","#replayOverlayElement","#viewBoxHeight","model","VisualLogging.item","IconButton.Icon.create","numberOfAnimations","timeToPixelRatio","startPoint","endPoint","y"],"mappings":"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;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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"}