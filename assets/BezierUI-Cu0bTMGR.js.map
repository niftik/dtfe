{"version":3,"file":"BezierUI-Cu0bTMGR.js","sources":["../../ui/legacy/components/inline_editor/BezierUI.js"],"sourcesContent":["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport * as VisualLogging from '../../../visual_logging/visual_logging.js';\nimport * as UI from '../../legacy.js';\nexport class BezierUI {\n    width;\n    height;\n    marginTop;\n    radius;\n    shouldDrawLine;\n    constructor({ width, height, marginTop, controlPointRadius, shouldDrawLine }) {\n        this.width = width;\n        this.height = height;\n        this.marginTop = marginTop;\n        this.radius = controlPointRadius;\n        this.shouldDrawLine = shouldDrawLine;\n    }\n    static drawVelocityChart(bezier, path, width) {\n        const height = Height;\n        let pathBuilder = ['M', 0, height];\n        /** @const */ const sampleSize = 1 / 40;\n        let prev = bezier.evaluateAt(0);\n        for (let t = sampleSize; t < 1 + sampleSize; t += sampleSize) {\n            const current = bezier.evaluateAt(t);\n            let slope = (current.y - prev.y) / (current.x - prev.x);\n            const weightedX = prev.x * (1 - t) + current.x * t;\n            slope = Math.tanh(slope / 1.5); // Normalise slope\n            pathBuilder = pathBuilder.concat(['L', (weightedX * width).toFixed(2), (height - slope * height).toFixed(2)]);\n            prev = current;\n        }\n        pathBuilder = pathBuilder.concat(['L', width.toFixed(2), height, 'Z']);\n        path.setAttribute('d', pathBuilder.join(' '));\n    }\n    curveWidth() {\n        return this.width - this.radius * 2;\n    }\n    curveHeight() {\n        return this.height - this.radius * 2 - this.marginTop * 2;\n    }\n    drawLine(parentElement, className, x1, y1, x2, y2) {\n        const line = UI.UIUtils.createSVGChild(parentElement, 'line', className);\n        line.setAttribute('x1', String(x1 + this.radius));\n        line.setAttribute('y1', String(y1 + this.radius + this.marginTop));\n        line.setAttribute('x2', String(x2 + this.radius));\n        line.setAttribute('y2', String(y2 + this.radius + this.marginTop));\n    }\n    drawControlPoints(parentElement, startX, startY, controlX, controlY) {\n        this.drawLine(parentElement, 'bezier-control-line', startX, startY, controlX, controlY);\n        const circle = UI.UIUtils.createSVGChild(parentElement, 'circle', 'bezier-control-circle');\n        circle.setAttribute('jslog', `${VisualLogging.controlPoint('bezier.control-circle').track({ drag: true })}`);\n        circle.setAttribute('cx', String(controlX + this.radius));\n        circle.setAttribute('cy', String(controlY + this.radius + this.marginTop));\n        circle.setAttribute('r', String(this.radius));\n    }\n    drawCurve(bezier, svg) {\n        if (!bezier) {\n            return;\n        }\n        const width = this.curveWidth();\n        const height = this.curveHeight();\n        svg.setAttribute('width', String(this.width));\n        svg.setAttribute('height', String(this.height));\n        svg.removeChildren();\n        const group = UI.UIUtils.createSVGChild(svg, 'g');\n        if (this.shouldDrawLine) {\n            this.drawLine(group, 'linear-line', 0, height, width, 0);\n        }\n        const curve = UI.UIUtils.createSVGChild(group, 'path', 'bezier-path');\n        const curvePoints = [\n            new UI.Geometry.Point(bezier.controlPoints[0].x * width + this.radius, (1 - bezier.controlPoints[0].y) * height + this.radius + this.marginTop),\n            new UI.Geometry.Point(bezier.controlPoints[1].x * width + this.radius, (1 - bezier.controlPoints[1].y) * height + this.radius + this.marginTop),\n            new UI.Geometry.Point(width + this.radius, this.marginTop + this.radius),\n        ];\n        curve.setAttribute('d', 'M' + this.radius + ',' + (height + this.radius + this.marginTop) + ' C' + curvePoints.join(' '));\n        this.drawControlPoints(group, 0, height, bezier.controlPoints[0].x * width, (1 - bezier.controlPoints[0].y) * height);\n        this.drawControlPoints(group, width, 0, bezier.controlPoints[1].x * width, (1 - bezier.controlPoints[1].y) * height);\n    }\n}\nexport const Height = 26;\n//# sourceMappingURL=BezierUI.js.map"],"names":["BezierUI","width","height","marginTop","controlPointRadius","shouldDrawLine","bezier","path","Height","pathBuilder","sampleSize","prev","t","current","slope","weightedX","parentElement","className","x1","y1","x2","y2","line","UI.UIUtils.createSVGChild","startX","startY","controlX","controlY","circle","VisualLogging.controlPoint","svg","group","curve","curvePoints","UI.Geometry.Point"],"mappings":"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"}