{"version":3,"file":"PopoverHelper-fEnxzApM.js","sources":["../../ui/legacy/popover.css.legacy.js","../../ui/legacy/PopoverHelper.js"],"sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n// IMPORTANT: this file is auto generated. Please do not edit this file.\n/* istanbul ignore file */\nexport default {\n  cssContent: `/*\n * Copyright 2017 The Chromium Authors. All rights reserved.\n * Use of this source code is governed by a BSD-style license that can be\n * found in the LICENSE file.\n */\n\n.widget {\n  display: flex;\n  background: var(--sys-color-cdt-base-container);\n  border: 1px solid transparent;\n  box-shadow: var(--drop-shadow);\n  border-radius: 2px;\n  overflow: auto;\n  user-select: text;\n  line-height: 11px;\n\n  &.borderless-popover {\n    border: 0;\n  }\n}\n\n.widget.has-padding {\n  padding: 6px;\n}\n\n/*# sourceURL=popover.css */\n`\n};\n","/*\n * Copyright (C) 2009 Google Inc. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\nimport * as VisualLogging from '../visual_logging/visual_logging.js';\nimport { GlassPane } from './GlassPane.js';\nimport popoverStyles from './popover.css.legacy.js';\nexport class PopoverHelper {\n    static createPopover = (jslogContext) => {\n        const popover = new GlassPane(`${VisualLogging.popover(jslogContext).parent('mapped')}`);\n        popover.registerRequiredCSS(popoverStyles);\n        popover.setSizeBehavior(\"MeasureContent\" /* SizeBehavior.MEASURE_CONTENT */);\n        popover.setMarginBehavior(\"Arrow\" /* MarginBehavior.ARROW */);\n        return popover;\n    };\n    disableOnClick;\n    hasPadding;\n    getRequest;\n    scheduledRequest;\n    hidePopoverCallback;\n    container;\n    showTimeout;\n    hideTimeout;\n    hidePopoverTimer;\n    showPopoverTimer;\n    boundMouseDown;\n    boundMouseMove;\n    boundMouseOut;\n    jslogContext;\n    constructor(container, getRequest, jslogContext) {\n        this.disableOnClick = false;\n        this.hasPadding = false;\n        this.getRequest = getRequest;\n        this.jslogContext = jslogContext;\n        this.scheduledRequest = null;\n        this.hidePopoverCallback = null;\n        this.container = container;\n        this.showTimeout = 0;\n        this.hideTimeout = 0;\n        this.hidePopoverTimer = null;\n        this.showPopoverTimer = null;\n        this.boundMouseDown = this.mouseDown.bind(this);\n        this.boundMouseMove = this.mouseMove.bind(this);\n        this.boundMouseOut = this.mouseOut.bind(this);\n        this.container.addEventListener('mousedown', this.boundMouseDown, false);\n        this.container.addEventListener('mousemove', this.boundMouseMove, false);\n        this.container.addEventListener('mouseout', this.boundMouseOut, false);\n        this.setTimeout(1000);\n    }\n    setTimeout(showTimeout, hideTimeout) {\n        this.showTimeout = showTimeout;\n        this.hideTimeout = typeof hideTimeout === 'number' ? hideTimeout : showTimeout / 2;\n    }\n    setHasPadding(hasPadding) {\n        this.hasPadding = hasPadding;\n    }\n    setDisableOnClick(disableOnClick) {\n        this.disableOnClick = disableOnClick;\n    }\n    eventInScheduledContent(ev) {\n        const event = ev;\n        return this.scheduledRequest ? this.scheduledRequest.box.contains(event.clientX, event.clientY) : false;\n    }\n    mouseDown(event) {\n        if (this.disableOnClick) {\n            this.hidePopover();\n            return;\n        }\n        if (this.eventInScheduledContent(event)) {\n            return;\n        }\n        this.startHidePopoverTimer(0);\n        this.stopShowPopoverTimer();\n        this.startShowPopoverTimer(event, 0);\n    }\n    mouseMove(ev) {\n        const event = ev;\n        if (this.eventInScheduledContent(event)) {\n            // Reschedule showing popover since mouse moved and\n            // we only want to show the popover when the mouse is\n            // standing still on the container for some amount of time.\n            this.stopShowPopoverTimer();\n            this.startShowPopoverTimer(event, this.isPopoverVisible() ? this.showTimeout * 0.6 : this.showTimeout);\n            return;\n        }\n        this.startHidePopoverTimer(this.hideTimeout);\n        this.stopShowPopoverTimer();\n        if (event.buttons && this.disableOnClick) {\n            return;\n        }\n        this.startShowPopoverTimer(event, this.isPopoverVisible() ? this.showTimeout * 0.6 : this.showTimeout);\n    }\n    popoverMouseMove(_event) {\n        this.stopHidePopoverTimer();\n    }\n    popoverMouseOut(popover, ev) {\n        const event = ev;\n        if (!popover.isShowing()) {\n            return;\n        }\n        const node = event.relatedTarget;\n        if (node && !node.isSelfOrDescendant(popover.contentElement)) {\n            this.startHidePopoverTimer(this.hideTimeout);\n        }\n    }\n    mouseOut(event) {\n        if (!this.isPopoverVisible()) {\n            return;\n        }\n        if (!this.eventInScheduledContent(event)) {\n            this.startHidePopoverTimer(this.hideTimeout);\n        }\n    }\n    startHidePopoverTimer(timeout) {\n        // User has |timeout| ms to reach the popup.\n        if (!this.hidePopoverCallback || this.hidePopoverTimer) {\n            return;\n        }\n        this.hidePopoverTimer = window.setTimeout(() => {\n            this.hidePopoverInternal();\n            this.hidePopoverTimer = null;\n        }, timeout);\n    }\n    startShowPopoverTimer(event, timeout) {\n        this.scheduledRequest = this.getRequest.call(null, event);\n        if (!this.scheduledRequest) {\n            return;\n        }\n        this.showPopoverTimer = window.setTimeout(() => {\n            this.showPopoverTimer = null;\n            this.stopHidePopoverTimer();\n            this.hidePopoverInternal();\n            const document = (event.target.ownerDocument);\n            this.showPopover(document);\n        }, timeout);\n    }\n    stopShowPopoverTimer() {\n        if (!this.showPopoverTimer) {\n            return;\n        }\n        clearTimeout(this.showPopoverTimer);\n        this.showPopoverTimer = null;\n    }\n    isPopoverVisible() {\n        return Boolean(this.hidePopoverCallback);\n    }\n    hidePopover() {\n        this.stopShowPopoverTimer();\n        this.hidePopoverInternal();\n    }\n    hidePopoverInternal() {\n        if (!this.hidePopoverCallback) {\n            return;\n        }\n        this.hidePopoverCallback.call(null);\n        this.hidePopoverCallback = null;\n    }\n    showPopover(document) {\n        const popover = PopoverHelper.createPopover(this.jslogContext);\n        const request = this.scheduledRequest;\n        if (!request) {\n            return;\n        }\n        void request.show.call(null, popover).then(success => {\n            if (!success) {\n                return;\n            }\n            if (this.scheduledRequest !== request) {\n                if (request.hide) {\n                    request.hide.call(null);\n                }\n                return;\n            }\n            // This should not happen, but we hide previous popover to be on the safe side.\n            if (popoverHelperInstance) {\n                popoverHelperInstance.hidePopover();\n            }\n            popoverHelperInstance = this;\n            VisualLogging.setMappedParent(popover.contentElement, this.container);\n            popover.contentElement.classList.toggle('has-padding', this.hasPadding);\n            popover.contentElement.addEventListener('mousemove', this.popoverMouseMove.bind(this), true);\n            popover.contentElement.addEventListener('mouseout', this.popoverMouseOut.bind(this, popover), true);\n            popover.setContentAnchorBox(request.box);\n            popover.show(document);\n            this.hidePopoverCallback = () => {\n                if (request.hide) {\n                    request.hide.call(null);\n                }\n                popover.hide();\n                popoverHelperInstance = null;\n            };\n        });\n    }\n    stopHidePopoverTimer() {\n        if (!this.hidePopoverTimer) {\n            return;\n        }\n        clearTimeout(this.hidePopoverTimer);\n        this.hidePopoverTimer = null;\n        // We know that we reached the popup, but we might have moved over other elements.\n        // Discard pending command.\n        this.stopShowPopoverTimer();\n    }\n    dispose() {\n        this.container.removeEventListener('mousedown', this.boundMouseDown, false);\n        this.container.removeEventListener('mousemove', this.boundMouseMove, false);\n        this.container.removeEventListener('mouseout', this.boundMouseOut, false);\n    }\n}\nlet popoverHelperInstance = null;\n//# sourceMappingURL=PopoverHelper.js.map"],"names":["popoverStyles","PopoverHelper","jslogContext","popover","GlassPane","VisualLogging.popover","container","getRequest","showTimeout","hideTimeout","hasPadding","disableOnClick","ev","event","_event","node","timeout","document","request","success","popoverHelperInstance","VisualLogging.setMappedParent"],"mappings":"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"}