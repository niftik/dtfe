import{b as E,g as S,T as V,c as F,d as b,C as I,e as f,f as W,u as x,V as O,h as $,i as l,j as s,k as c,l as L,m as k,a as H}from"./inspector-CyOA7R9n.js";const o={sErrors:"{n, plural, =1 {# error} other {# errors}}",sWarnings:"{n, plural, =1 {# warning} other {# warnings}}",openConsoleToViewS:"Open Console to view {PH1}",openIssuesToView:"{n, plural, =1 {Open Issues to view # issue:} other {Open Issues to view # issues:}}"},N=E("panels/console_counters/WarningErrorCounter.ts",o),r=S.bind(void 0,N);let d;class a{toolbarItem;consoleCounter;issueCounter;throttler;updatingForTest;constructor(){a.instanceForTest=this;const e=document.createElement("div");this.toolbarItem=new V(e),this.toolbarItem.setVisible(!1),this.toolbarItem.addEventListener("CompactLayoutUpdated",this.onSetCompactLayout,this),this.consoleCounter=new F,this.consoleCounter.setAttribute("jslog",`${b("console").track({click:!0})}`),e.appendChild(this.consoleCounter),this.consoleCounter.data={clickHandler:I.instance().show.bind(I.instance()),groups:[{iconName:"cross-circle-filled",iconColor:"var(--icon-error)",iconHeight:"14px",iconWidth:"14px"},{iconName:"warning-filled",iconColor:"var(--icon-warning)",iconHeight:"14px",iconWidth:"14px"}]};const t=f.instance();this.issueCounter=new W,this.issueCounter.classList.add("main-toolbar"),this.issueCounter.setAttribute("jslog",`${b("issue").track({click:!0})}`),e.appendChild(this.issueCounter),this.issueCounter.data={clickHandler:()=>{x.issuesPanelOpenedFrom(2),O.instance().showView("issues-pane")},issuesManager:t,displayMode:"OnlyMostImportant"},this.throttler=new $(100),l.instance().addModelListener(s,c.ConsoleCleared,this.update,this),l.instance().addModelListener(s,c.MessageAdded,this.update,this),l.instance().addModelListener(s,c.MessageUpdated,this.update,this),t.addEventListener("IssuesCountUpdated",this.update,this),this.update()}onSetCompactLayout(e){this.setCompactLayout(e.data)}setCompactLayout(e){this.consoleCounter.data={...this.consoleCounter.data,compact:e},this.issueCounter.data={...this.issueCounter.data,compact:e}}static instance(e={forceNew:null}){const{forceNew:t}=e;return(!d||t)&&(d=new a),d}updatedForTest(){}update(){this.updatingForTest=!0,this.throttler.schedule(this.updateThrottled.bind(this))}get titlesForTesting(){const e=this.consoleCounter.shadowRoot?.querySelector("button");return e?e.getAttribute("aria-label"):null}async updateThrottled(){const e=s.allErrors(),t=s.allWarnings(),h=f.instance(),u=h.numberOfIssues(),p=i=>i===0?void 0:`${i}`,C=r(o.sErrors,{n:e}),g=r(o.sWarnings,{n:t}),M=[p(e),p(t)];let n="";e&&t?n=`${C}, ${g}`:e?n=C:t&&(n=g);const m=r(o.openConsoleToViewS,{PH1:n}),T=this.consoleCounter.data;this.consoleCounter.data={...T,groups:T.groups.map((i,y)=>({...i,text:M[y]})),accessibleName:m},L.install(this.consoleCounter,m),this.consoleCounter.classList.toggle("hidden",!(e||t));const v=k(h),w=`${r(o.openIssuesToView,{n:u})} ${v}`;L.install(this.issueCounter,w),this.issueCounter.data={...this.issueCounter.data,accessibleName:w},this.issueCounter.classList.toggle("hidden",!u),this.toolbarItem.setVisible(!!(e||t||u)),H.instance().toolbarItemResized(),this.updatingForTest=!1,this.updatedForTest()}item(){return this.toolbarItem}static instanceForTest=null}const A=Object.freeze(Object.defineProperty({__proto__:null,WarningErrorCounter:a},Symbol.toStringTag,{value:"Module"}));export{A as WarningErrorCounter};
//# sourceMappingURL=console_counters-Tnl59uaA.js.map
